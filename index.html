<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADNOC Q1 2025 Internal Quarterly Review - North American Investors</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }

        .presentation-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 4px 20px rgba(0, 71, 186, 0.1);
        }

        .slide {
            min-height: 100vh;
            padding: 60px 80px;
            display: none;
            position: relative;
        }

        .slide.active {
            display: block;
        }

        .slide-header {
            border-bottom: 3px solid #0047BA;
            padding-bottom: 20px;
            margin-bottom: 40px;
        }

        .slide-number {
            color: #0047BA;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .slide-title {
            color: #0047BA;
            font-size: 32px;
            font-weight: 700;
            margin: 10px 0;
        }

        .slide-subtitle {
            color: #666;
            font-size: 18px;
            font-style: italic;
        }

        .content-section {
            margin-bottom: 40px;
        }

        .section-title {
            color: #0047BA;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .section-icon {
            width: 24px;
            height: 24px;
            margin-right: 12px;
            fill: #0047BA;
        }

        .chart-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0, 71, 186, 0.1);
            height: 500px;
            position: relative;
        }

        .chart-container.large {
            height: 600px;
        }

        .chart-container.small {
            height: 550px;
        }

        .chart-title {
            color: #0047BA;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin-bottom: 30px;
        }

        .analysis-card {
            background: #ffffff;
            border: 1px solid #e1e5e9;
            border-radius: 6px;
            padding: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .analysis-card:hover {
            box-shadow: 0 2px 8px rgba(0, 71, 186, 0.08);
            border-color: #d1d9e0;
        }

        .analysis-card.warning {
            border-left: 3px solid #f39c12;
            background: #ffffff;
        }

        .analysis-card.critical {
            border-left: 3px solid #e74c3c;
            background: #ffffff;
        }

        .analysis-card.positive {
            border-left: 3px solid #27ae60;
            background: #ffffff;
        }

        .card-title {
            color: #2c3e50;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .card-title.warning {
            color: #d68910;
        }

        .card-title.critical {
            color: #c0392b;
        }

        .card-title.positive {
            color: #229954;
        }

        .metric-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .metric-change {
            font-size: 14px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 12px;
        }

        .change-positive {
            background: rgba(40, 167, 69, 0.1);
            color: #28a745;
        }

        .change-negative {
            background: rgba(220, 53, 69, 0.1);
            color: #dc3545;
        }

        .insights-list {
            list-style: none;
            margin: 8px 0;
        }

        .insights-list li {
            color: #4a5568;
            margin-bottom: 6px;
            padding-left: 16px;
            position: relative;
            font-size: 13px;
            line-height: 1.4;
        }

        .insights-list li::before {
            content: "•";
            color: #718096;
            font-weight: normal;
            position: absolute;
            left: 0;
            font-size: 16px;
        }

        .risk-indicator {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 700;
            margin-left: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: 1px solid;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .risk-high {
            background: linear-gradient(135deg, #0047BA, #003a9e);
            color: #ffffff;
            border-color: #003a9e;
        }

        .risk-medium {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            color: #0047BA;
            border-color: #0047BA;
        }

        .risk-low {
            background: linear-gradient(135deg, #e8f4fd, #d1e7dd);
            color: #0047BA;
            border-color: #0047BA;
        }

        .competitive-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 71, 186, 0.1);
            font-size: 11px;
        }

        .competitive-table th,
        .competitive-table td {
            padding: 8px 12px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
            font-size: 11px;
        }

        .competitive-table th {
            background: #0047BA;
            color: white;
            font-weight: 600;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .competitive-table tr:hover {
            background: #f8f9fa;
        }

        .score-cell {
            font-weight: 600;
        }

        .score-leading {
            color: #28a745;
        }

        .score-lagging {
            color: #dc3545;
        }

        .recommendations-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 20px 0;
        }

        .recommendation-card {
            background: #f8f9fa;
            border-left: 4px solid #0047BA;
            padding: 20px;
            border-radius: 0 8px 8px 0;
        }

        .recommendation-card.priority-high {
            border-left-color: #dc3545;
        }

        .recommendation-card.priority-medium {
            border-left-color: #ffc107;
        }

        .rec-title {
            color: #0047BA;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .rec-title.priority-high {
            color: #dc3545;
        }

        .rec-title.priority-medium {
            color: #856404;
        }

        .rec-description {
            color: #555;
            font-size: 13px;
            line-height: 1.4;
            margin-bottom: 10px;
        }

        .rec-impact {
            font-size: 12px;
            font-weight: 600;
            color: #666;
        }

        .navigation {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .nav-btn {
            background: #0047BA;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: #003a9e;
            transform: translateY(-2px);
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .slide-indicator {
            position: fixed;
            bottom: 30px;
            left: 30px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        .indicator-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ccc;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .indicator-dot.active {
            background: #0047BA;
            transform: scale(1.2);
        }

        .executive-summary {
            background: #e8f4fd;
            border: 1px solid #0047BA;
            border-radius: 8px;
            padding: 25px;
            margin: 20px 0;
        }

        .executive-summary h4 {
            color: #0047BA;
            font-size: 16px;
            margin-bottom: 15px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .summary-metric {
            text-align: center;
        }

        .summary-value {
            font-size: 24px;
            font-weight: 700;
            color: #0047BA;
        }

        .summary-label {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        .kpi-cards-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin: 20px 0;
        }

        .kpi-card {
            background: #ffffff;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .kpi-card:hover {
            box-shadow: 0 4px 12px rgba(0, 71, 186, 0.1);
            border-color: #0047BA;
        }

        .kpi-card.positive {
            border-left: 4px solid #27ae60;
        }

        .kpi-card.warning {
            border-left: 4px solid #f39c12;
        }

        .kpi-card.info {
            border-left: 4px solid #0047BA;
        }

        .kpi-value {
            font-size: 24px;
            font-weight: 700;
            color: #0047BA;
            margin-bottom: 5px;
        }

        .kpi-label {
            font-size: 12px;
            color: #666;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .kpi-context {
            font-size: 11px;
            color: #888;
            margin-top: 3px;
        }

        .charts-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin: 25px 0;
        }

        .charts-column {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
            margin: 25px 0;
        }

        .trust-analysis-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 25px 0;
            /* Performance optimizations */
            contain: layout style paint;
            will-change: transform;
            transform: translateZ(0);
            /* Accessibility improvements */
            position: relative;
            isolation: isolate;
        }

        /* Enhanced responsive design for trust-analysis-grid */
        @media (max-width: 1199px) {
            .trust-analysis-grid {
                gap: 18px;
                margin: 20px 0;
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 991px) {
            .trust-analysis-grid {
                gap: 15px;
                margin: 18px 0;
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 767px) {
            .trust-analysis-grid {
                grid-template-columns: 1fr;
                gap: 15px;
                margin: 15px 0;
            }
        }

        @media (max-width: 479px) {
            .trust-analysis-grid {
                grid-template-columns: 1fr;
                gap: 12px;
                margin: 12px 0;
            }
        }

        /* Trust grid interactive enhancements */
        .trust-analysis-grid:focus-within {
            outline: 2px solid #0047BA;
            outline-offset: 4px;
            border-radius: 8px;
        }

        .trust-analysis-grid .chart-container {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            transform-origin: center;
        }

        .trust-analysis-grid .chart-container:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 71, 186, 0.15);
        }

        .trust-analysis-grid .chart-container:focus {
            outline: 2px solid #0047BA;
            outline-offset: 2px;
        }

        /* Optimized trust-compact containers - Enhanced Desktop Sizing with X-Axis Fix */
        .chart-container.trust-compact {
            height: 420px;
            padding: 25px 20px 45px 20px;
            background: #ffffff;
            border-radius: 10px;
            box-shadow: 0 3px 12px rgba(0, 71, 186, 0.12);
            border: 1px solid #e1e5e9;
            /* Performance optimizations */
            contain: layout style;
            backface-visibility: hidden;
            /* Accessibility */
            position: relative;
            overflow: visible;
        }

        /* Enhanced responsive sizing for trust-compact with X-axis visibility */
        @media (max-width: 1199px) {
            .chart-container.trust-compact {
                height: 380px;
                padding: 22px 18px 40px 18px;
            }
        }

        @media (max-width: 991px) {
            .chart-container.trust-compact {
                height: 350px;
                padding: 20px 16px 35px 16px;
            }
        }

        @media (max-width: 767px) {
            .chart-container.trust-compact {
                height: 310px;
                padding: 18px 15px 30px 15px;
            }
        }

        @media (max-width: 479px) {
            .chart-container.trust-compact {
                height: 280px;
                padding: 15px 12px 25px 12px;
            }
        }

        /* Loading state for trust analysis charts */
        .trust-analysis-grid .chart-container.loading {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading-shimmer 1.5s infinite;
        }

        @keyframes loading-shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .trust-analysis-grid .chart-container {
                border: 2px solid #000000;
                box-shadow: none;
            }
            
            .trust-analysis-grid .chart-container:hover {
                border-color: #0047BA;
                box-shadow: 0 0 0 3px rgba(0, 71, 186, 0.3);
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            .trust-analysis-grid .chart-container {
                transition: none;
            }
            
            .trust-analysis-grid .chart-container:hover {
                transform: none;
            }
            
            .loading-shimmer {
                animation: none;
            }
        }

        /* Print styles for trust analysis grid */
        @media print {
            .trust-analysis-grid {
                grid-template-columns: 1fr;
                gap: 20px;
                page-break-inside: avoid;
            }
            
            .trust-analysis-grid .chart-container {
                box-shadow: none;
                border: 1px solid #000000;
                page-break-inside: avoid;
            }
        }

        .chart-container.compact {
            height: 420px;
            padding: 20px;
        }

        .chart-container.mini {
            height: 420px;
            padding: 15px;
        }

        .chart-container.trust-compact {
            height: 320px;
            padding: 20px;
        }

        .progress-bars-container {
            position: relative;
            z-index: 10;
            isolation: isolate;
        }

        .chart-container.trust-damagers-container {
            height: 780px;
        }

        /* Mobile responsive for trust damagers container */
        @media (max-width: 479px) {
            .chart-container.trust-damagers-container {
                height: 480px;
            }
        }

        .data-summary {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .data-summary h4 {
            color: #0047BA;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .summary-section {
            margin-bottom: 15px;
        }

        .summary-section h5 {
            color: #2c3e50;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .summary-items {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }

        .summary-item {
            font-size: 12px;
            color: #555;
            background: white;
            padding: 5px 10px;
            border-radius: 4px;
            border: 1px solid #e1e5e9;
        }

        .methodology-note {
            margin-top: 15px;
            padding: 10px 15px;
            background: #f8f9fa;
            border-left: 3px solid #dee2e6;
            border-radius: 0 4px 4px 0;
            font-size: 11px;
            color: #6c757d;
            line-height: 1.4;
        }

        .methodology-note p {
            margin: 0;
        }

        .methodology-note strong {
            color: #495057;
            font-weight: 600;
        }

        /* Enhanced Mobile Responsive */
        
        /* Tablets and Large Mobile - 1199px and below */
        @media (max-width: 1199px) {
            .presentation-container {
                max-width: 100%;
                margin: 0;
            }
            
            .slide {
                padding: 50px 40px;
            }
            
            .kpi-cards-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .kpi-card {
                height: 100px;
                padding: 15px;
            }
            
            .analysis-grid {
                gap: 25px;
            }
            
            .charts-row {
                gap: 20px;
            }
        }

        /* Standard Tablets - 768px to 1199px */
        @media (max-width: 768px) {
            .slide {
                padding: 40px 30px;
                min-height: auto;
            }

            .slide-title {
                font-size: 28px;
                line-height: 1.2;
            }
            
            .slide-subtitle {
                font-size: 16px;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .recommendations-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .summary-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .kpi-cards-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .kpi-card {
                height: 90px;
                padding: 12px;
            }
            
            .charts-row {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .charts-column {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .chart-container.compact,
            .chart-container.mini {
                height: 300px;
            }
            
            .competitive-table {
                font-size: 12px;
                overflow-x: auto;
                display: block;
                white-space: nowrap;
            }
            
            .competitive-table th,
            .competitive-table td {
                padding: 8px 10px;
            }

            .navigation {
                bottom: 20px;
                right: 20px;
            }

            .slide-indicator {
                bottom: 20px;
                left: 20px;
            }
            
            .nav-btn {
                padding: 14px 20px;
                font-size: 14px;
                min-height: 44px;
                min-width: 44px;
            }
            
            .indicator-dot {
                width: 16px;
                height: 16px;
            }
        }

        /* Mobile Devices - 480px to 767px */
        @media (max-width: 479px) {
            .slide {
                padding: 30px 15px;
                overflow-x: hidden;
            }

            .slide-title {
                font-size: 24px;
                line-height: 1.3;
            }
            
            .slide-subtitle {
                font-size: 14px;
            }
            
            .section-title {
                font-size: 18px;
                flex-direction: column;
                align-items: flex-start;
                text-align: left;
            }
            
            .section-icon {
                margin-bottom: 8px;
                margin-right: 0;
            }

            .kpi-cards-grid {
                grid-template-columns: 1fr;
                gap: 12px;
                margin: 15px 0;
            }
            
            .kpi-card {
                height: 80px;
                padding: 10px;
                min-width: 0;
            }
            
            .kpi-value {
                font-size: 18px;
                margin-bottom: 3px;
            }
            
            .kpi-label {
                font-size: 11px;
                line-height: 1.2;
            }
            
            .kpi-context {
                font-size: 9px;
                margin-top: 2px;
            }
            
            .summary-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .summary-value {
                font-size: 20px;
            }
            
            .summary-label {
                font-size: 11px;
            }
            
            .chart-container,
            .chart-container.compact,
            .chart-container.mini,
            .chart-container.small {
                height: 260px;
                padding: 10px;
                margin: 12px 0;
                width: 100%;
                max-width: calc(100vw - 30px);
                overflow: hidden;
            }
            
            .charts-row {
                gap: 12px;
                margin: 15px 0;
            }
            
            .chart-title {
                font-size: 14px;
                margin-bottom: 10px;
            }
            
            .competitive-table {
                font-size: 10px;
            }
            
            .competitive-table th,
            .competitive-table td {
                padding: 6px 8px;
            }
            
            .analysis-card,
            .recommendation-card {
                padding: 12px;
            }
            
            .card-title {
                font-size: 12px;
            }
            
            .insights-list li {
                font-size: 12px;
            }
            
            .data-summary {
                padding: 15px;
            }
            
            .summary-items {
                gap: 10px;
            }
            
            .summary-item {
                font-size: 11px;
                padding: 4px 8px;
            }

            .nav-btn {
                padding: 12px 18px;
                font-size: 13px;
                min-height: 48px;
                min-width: 48px;
            }
            
            .navigation {
                bottom: 15px;
                right: 15px;
                gap: 8px;
            }
            
            .slide-indicator {
                bottom: 15px;
                left: 15px;
            }
            
            .indicator-dot {
                width: 14px;
                height: 14px;
            }
        }

        /* Small Mobile Devices - 320px to 479px */
        @media (max-width: 320px) {
            .slide {
                padding: 20px 15px;
            }
            
            .slide-title {
                font-size: 20px;
            }
            
            .slide-subtitle {
                font-size: 13px;
            }
            
            .kpi-card {
                height: 90px;
                padding: 12px;
            }
            
            .kpi-value {
                font-size: 18px;
            }
            
            .chart-container,
            .chart-container.compact,
            .chart-container.mini,
            .chart-container.small {
                height: 250px;
                padding: 10px;
            }
            
            .nav-btn {
                padding: 10px 14px;
                font-size: 12px;
            }
        }

        /* Executive Insights Styling */
        .executive-insights-container {
            background: #ffffff;
            border-radius: 8px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0, 71, 186, 0.1);
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .executive-insight-card {
            background: #ffffff;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .executive-insight-card:hover {
            box-shadow: 0 4px 12px rgba(0, 71, 186, 0.08);
            border-color: #0047BA;
        }

        .insight-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 1px solid #f0f0f0;
        }

        .insight-icon {
            margin-right: 12px;
            flex-shrink: 0;
        }

        .insight-title {
            color: #0047BA;
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            flex-grow: 1;
        }

        .insight-metric {
            color: #27ae60;
            font-size: 20px;
            font-weight: 700;
            margin-left: 15px;
        }

        .insight-content {
            margin-top: 15px;
        }

        .insight-description {
            color: #2c3e50;
            font-size: 15px;
            font-weight: 500;
            line-height: 1.4;
            margin-bottom: 12px;
        }

        .insight-impacts {
            margin-top: 10px;
        }

        .impact-item {
            color: #4a5568;
            font-size: 13px;
            line-height: 1.5;
            margin-bottom: 6px;
            padding-left: 0;
        }

        .supporting-metrics {
            margin-top: 30px;
            padding: 25px;
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 71, 186, 0.1);
            border: 1px solid #e1e5e9;
        }

        .metrics-section {
            margin-bottom: 25px;
        }

        .metrics-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .metrics-header h5 {
            color: #0047BA;
            font-size: 14px;
            font-weight: 700;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .metrics-icon {
            margin-right: 10px;
            flex-shrink: 0;
        }

        .metrics-summary {
            color: #666;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            background: #f8f9fa;
            padding: 4px 8px;
            border-radius: 12px;
            border: 1px solid #e1e5e9;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
        }

        .metric-card {
            background: #ffffff;
            border: 1px solid #e1e5e9;
            border-radius: 4px;
            padding: 10px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
        }

        .metric-card:hover {
            box-shadow: 0 2px 6px rgba(0, 71, 186, 0.08);
            border-color: #0047BA;
            transform: translateY(-1px);
        }

        .metric-card.critical {
            border-left: 3px solid #e74c3c;
            background: #ffffff;
        }

        .metric-card.warning {
            border-left: 3px solid #f39c12;
            background: #ffffff;
        }

        .metric-card.moderate {
            border-left: 3px solid #95a5a6;
            background: #ffffff;
        }

        .metric-card.positive {
            border-left: 3px solid #27ae60;
            background: #ffffff;
        }

        .metric-card.info {
            border-left: 3px solid #0047BA;
            background: #ffffff;
        }

        .metric-label {
            color: #2c3e50;
            font-size: 10px;
            font-weight: 600;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.2;
        }

        .metric-value {
            color: #0047BA;
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 4px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .metric-status {
            font-size: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            padding: 2px 6px;
            border-radius: 8px;
            display: inline-block;
            margin-top: 3px;
        }

        .metric-card.critical .metric-status {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.2);
        }

        .metric-card.warning .metric-status {
            background: rgba(243, 156, 18, 0.1);
            color: #f39c12;
            border: 1px solid rgba(243, 156, 18, 0.2);
        }

        .metric-card.moderate .metric-status {
            background: rgba(149, 165, 166, 0.1);
            color: #95a5a6;
            border: 1px solid rgba(149, 165, 166, 0.2);
        }

        .metric-card.positive .metric-status {
            background: rgba(39, 174, 96, 0.1);
            color: #27ae60;
            border: 1px solid rgba(39, 174, 96, 0.2);
        }

        .metric-card.info .metric-status {
            background: rgba(0, 71, 186, 0.1);
            color: #0047BA;
            border: 1px solid rgba(0, 71, 186, 0.2);
        }

        /* Mobile responsive for supporting metrics */
        @media (max-width: 768px) {
            .supporting-metrics {
                padding: 20px;
                margin-top: 25px;
            }

            .metrics-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .metric-card {
                padding: 12px;
            }

            .metrics-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .metrics-header h5 {
                font-size: 13px;
            }

            .metric-value {
                font-size: 18px;
            }

            .metric-label {
                font-size: 11px;
            }
        }

        @media (max-width: 479px) {
            .supporting-metrics {
                padding: 15px;
                margin-top: 20px;
            }

            .metrics-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .metric-card {
                padding: 10px;
            }

            .metrics-header h5 {
                font-size: 12px;
            }

            .metric-value {
                font-size: 16px;
            }

            .metric-label {
                font-size: 10px;
            }

            .metric-status {
                font-size: 9px;
                padding: 2px 6px;
            }
        }

        /* Touch-friendly enhancements */
        @media (hover: none) and (pointer: coarse) {
            .nav-btn,
            .indicator-dot {
                transform: scale(1.1);
            }
            
            .kpi-card:hover,
            .analysis-card:hover,
            .executive-insight-card:hover {
                transform: none;
                box-shadow: 0 2px 8px rgba(0, 71, 186, 0.1);
            }
        }

        /* Secondary Insights Styling */
        .secondary-insights-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .secondary-insight-card {
            background: #ffffff;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .secondary-insight-card:hover {
            box-shadow: 0 4px 12px rgba(0, 71, 186, 0.08);
            border-color: #0047BA;
        }

        .secondary-insight-header {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 1px solid #f0f0f0;
        }

        .secondary-insight-title {
            color: #0047BA;
            font-size: 12px;
            font-weight: 700;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            line-height: 1.2;
            flex-grow: 1;
        }

        .secondary-insight-metric {
            color: #27ae60;
            font-size: 16px;
            font-weight: 700;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin-left: 12px;
        }

        .secondary-insight-content {
            margin-top: 12px;
        }

        .secondary-insight-description {
            color: #2c3e50;
            font-size: 15px;
            font-weight: 500;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.4;
            margin-bottom: 12px;
        }

        .secondary-insight-impacts {
            margin-top: 8px;
        }

        .secondary-impact-item {
            color: #4a5568;
            font-size: 13px;
            font-weight: 400;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.5;
            margin-bottom: 6px;
            padding-left: 0;
        }

        /* Mobile responsive for executive insights */
        @media (max-width: 768px) {
            .executive-insights-container {
                padding: 20px;
            }
            
            .insights-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .executive-insight-card {
                padding: 15px;
            }
            
            .insight-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .insight-metric {
                margin-left: 0;
                font-size: 18px;
            }
            
            .metrics-row {
                gap: 10px;
            }
            
            .metric-item {
                font-size: 11px;
                padding: 6px 10px;
            }

            .secondary-insights-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .secondary-insight-card {
                padding: 12px;
            }
            
            .secondary-insight-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 6px;
            }
            
            .secondary-insight-metric {
                margin-left: 0;
                font-size: 14px;
            }

            /* Make media analysis charts stack vertically on mobile */
            .remaining-charts-row {
                grid-template-columns: 1fr !important;
                gap: 15px;
            }
            
            /* Make Trust Impact Analysis charts stack vertically on mobile */
            .trust-analysis-grid {
                grid-template-columns: 1fr !important;
                gap: 15px;
            }
            
            /* Optimize media outlet table for mobile */
            .media-outlet-table-container {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .media-outlet-table {
                min-width: 500px;
                font-size: 9px;
            }
            
            .media-outlet-table th,
            .media-outlet-table td {
                padding: 4px 3px;
                white-space: nowrap;
            }
        }

        @media (max-width: 479px) {
            .executive-insights-container {
                padding: 15px;
                margin: 15px 0;
            }
            
            .executive-insight-card {
                padding: 12px;
            }
            
            .insight-title {
                font-size: 12px;
            }
            
            .insight-description {
                font-size: 13px;
            }
            
            .impact-item {
                font-size: 12px;
            }
            
            .metrics-section h5 {
                font-size: 12px;
            }
            
            .metric-item {
                font-size: 10px;
                padding: 5px 8px;
            }

            /* Executive Question Responses - Single column with 8 rows on mobile */
            .insights-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .secondary-insights-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .secondary-insight-card {
                padding: 10px;
            }
            
            .secondary-insight-title {
                font-size: 11px;
                line-height: 1.2;
            }
            
            .secondary-insight-description {
                font-size: 12px;
                line-height: 1.3;
            }
            
            .secondary-impact-item {
                font-size: 11px;
                line-height: 1.3;
            }
            
            .secondary-insight-metric {
                font-size: 13px;
            }
            
            /* Enhanced mobile optimization for media outlet table */
            .media-outlet-table-container {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                border-radius: 4px;
            }
            
            .media-outlet-table {
                min-width: 450px;
                font-size: 8px;
            }
            
            .media-outlet-table th,
            .media-outlet-table td {
                padding: 3px 2px;
                white-space: nowrap;
            }
            
            .tier-badge,
            .status-indicator {
                font-size: 6px;
                padding: 1px 2px;
            }
            
            .theme-tag {
                font-size: 7px;
                max-width: 40px;
            }
        }

        /* Campaign Dashboard Styling */
        .campaign-dashboard-container {
            background: #ffffff;
            border-radius: 8px;
            padding: 25px;
            margin: 25px 0;
            box-shadow: 0 2px 8px rgba(0, 71, 186, 0.1);
            border: 1px solid #e1e5e9;
        }

        .dashboard-title {
            color: #0047BA;
            font-size: 18px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 25px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .summary-cards-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        .summary-card {
            background: #f8f9fa;
            border: 1px solid #e1e5e9;
            border-radius: 6px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .summary-card:hover {
            box-shadow: 0 4px 12px rgba(0, 71, 186, 0.1);
            border-color: #0047BA;
        }

        .card-label {
            color: #666;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .card-value {
            color: #0047BA;
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .card-campaign {
            color: #555;
            font-size: 10px;
            font-weight: 500;
        }

        .metric-toggles {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .metric-toggle {
            background: #f8f9fa;
            border: 1px solid #e1e5e9;
            color: #555;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .metric-toggle:hover {
            border-color: #0047BA;
            color: #0047BA;
        }

        .metric-toggle.active {
            background: #0047BA;
            border-color: #0047BA;
            color: white;
        }

        .interactive-chart-container {
            background: #ffffff;
            border: 1px solid #e1e5e9;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 25px;
            height: 350px;
        }

        .campaign-data-table {
            overflow-x: auto;
            border-radius: 6px;
            border: 1px solid #e1e5e9;
        }

        #campaignTable {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }

        #campaignTable th {
            background: #0047BA;
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        #campaignTable td {
            padding: 10px 8px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
            font-size: 11px;
        }

        #campaignTable tbody tr:hover {
            background: #f8f9fa;
        }

        .sortable {
            cursor: pointer;
            position: relative;
        }

        .sortable:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Heatmap styling for table cells */
        .heatmap-cell {
            position: relative;
            transition: all 0.2s ease;
        }

        .heatmap-cell::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.15;
            pointer-events: none;
        }

        /* Performance level colors - Green to Red Gradient (Very Pale) */
        .performance-excellent::before {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            opacity: 0.15;
        }

        .performance-good::before {
            background: linear-gradient(135deg, #f39c12, #f1c40f);
            opacity: 0.15;
        }

        .performance-average::before {
            background: linear-gradient(135deg, #e67e22, #f39c12);
            opacity: 0.15;
        }

        .performance-below::before {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            opacity: 0.15;
        }

        .performance-poor::before {
            background: linear-gradient(135deg, #8b0000, #a0522d);
            opacity: 0.15;
        }

        /* Hover effects for heatmap cells */
        .heatmap-cell:hover::before {
            opacity: 0.95;
            transform: scale(1.01);
            box-shadow: inset 0 0 8px rgba(0, 71, 186, 0.3);
        }

        /* Text styling for maximum readability */
        .performance-excellent,
        .performance-good,
        .performance-average,
        .performance-below,
        .performance-poor {
            color: #000000;
            font-weight: 600;
            text-shadow: none;
            position: relative;
            z-index: 2;
        }

        /* Heatmap legend */
        .heatmap-legend {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-top: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            font-size: 11px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            opacity: 0.25;
        }

        .legend-excellent { background: linear-gradient(135deg, #27ae60, #2ecc71); }
        .legend-good { background: linear-gradient(135deg, #f39c12, #f1c40f); }
        .legend-average { background: linear-gradient(135deg, #e67e22, #f39c12); }
        .legend-below { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .legend-poor { background: linear-gradient(135deg, #8b0000, #a0522d); }

        .remaining-charts-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 25px 0;
        }

        /* Media Outlet Table Styling */
        .media-outlet-table-container {
            overflow-x: auto;
            height: calc(100% - 40px);
            border-radius: 6px;
            border: 1px solid #e1e5e9;
        }

        .media-outlet-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
            height: 100%;
        }

        .media-outlet-table th {
            background: #0047BA;
            color: white;
            padding: 8px 6px;
            text-align: center;
            font-weight: 600;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .media-outlet-table td {
            padding: 8px 6px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
            font-size: 10px;
            vertical-align: middle;
        }

        .media-outlet-table tbody tr:hover {
            background: #f8f9fa;
        }

        .media-outlet-table .sortable {
            cursor: pointer;
            position: relative;
            user-select: none;
        }

        .media-outlet-table .sortable:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        /* Tier badges */
        .tier-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 9px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .tier-1 {
            background: #0047BA;
            color: white;
        }

        .tier-2 {
            background: #95a5a6;
            color: white;
        }

        /* Performance status indicators */
        .status-indicator {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 9px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.2px;
        }

        .status-excellent {
            background: rgba(39, 174, 96, 0.15);
            color: #27ae60;
            border: 1px solid rgba(39, 174, 96, 0.3);
        }

        .status-good {
            background: rgba(243, 156, 18, 0.15);
            color: #f39c12;
            border: 1px solid rgba(243, 156, 18, 0.3);
        }

        .status-focus {
            background: rgba(231, 76, 60, 0.15);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        /* Sentiment performance coloring */
        .sentiment-excellent {
            background: rgba(39, 174, 96, 0.1);
            color: #27ae60;
            font-weight: 600;
        }

        .sentiment-good {
            background: rgba(243, 156, 18, 0.1);
            color: #f39c12;
            font-weight: 600;
        }

        .sentiment-focus {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
            font-weight: 600;
        }

        /* Theme tags */
        .theme-tag {
            font-size: 9px;
            color: #666;
            font-style: italic;
            max-width: 80px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Mobile responsive for media outlet table */
        @media (max-width: 768px) {
            .media-outlet-table {
                font-size: 9px;
            }

            .media-outlet-table th,
            .media-outlet-table td {
                padding: 6px 4px;
            }

            .tier-badge,
            .status-indicator {
                font-size: 8px;
                padding: 1px 4px;
            }

            .theme-tag {
                font-size: 8px;
                max-width: 60px;
            }
        }

        @media (max-width: 479px) {
            .media-outlet-table {
                font-size: 8px;
            }

            .media-outlet-table th,
            .media-outlet-table td {
                padding: 4px 3px;
            }

            .tier-badge,
            .status-indicator {
                font-size: 7px;
                padding: 1px 3px;
            }

            .theme-tag {
                font-size: 7px;
                max-width: 50px;
            }
        }

        /* Enhanced Mobile responsive for campaign dashboard with improved label visibility */
        @media (max-width: 768px) {
            .campaign-dashboard-container {
                padding: 20px;
                margin: 20px 0;
            }

            .summary-cards-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }

            .metric-toggles {
                gap: 6px;
            }

            .metric-toggle {
                padding: 6px 10px;
                font-size: 10px;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                min-width: 60px;
            }

            .interactive-chart-container {
                height: 280px;
                padding: 15px;
            }

            .remaining-charts-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            #campaignTable {
                font-size: 10px;
                min-width: 600px; /* Ensure horizontal scroll */
            }

            #campaignTable th,
            #campaignTable td {
                padding: 8px 6px;
                white-space: nowrap;
                min-width: 80px;
            }

            .campaign-data-table {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            /* Improved chart title visibility */
            .chart-title {
                font-size: 14px !important;
                line-height: 1.3;
                margin-bottom: 12px;
                word-wrap: break-word;
                hyphens: auto;
            }
        }

        @media (max-width: 479px) {
            .campaign-dashboard-container {
                padding: 15px;
                margin: 15px 0;
            }

            .dashboard-title {
                font-size: 16px;
                line-height: 1.2;
                word-wrap: break-word;
            }

            .summary-cards-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .card-value {
                font-size: 18px;
            }

            .card-label {
                font-size: 10px;
                line-height: 1.2;
            }

            .metric-toggles {
                gap: 4px;
                flex-wrap: wrap;
            }

            .metric-toggle {
                padding: 5px 8px;
                font-size: 9px;
                min-width: 50px;
                flex: 1 1 auto;
            }

            .interactive-chart-container {
                height: 250px;
                padding: 10px;
            }

            #campaignTable {
                font-size: 9px;
                min-width: 500px; /* Ensure horizontal scroll */
            }

            #campaignTable th,
            #campaignTable td {
                padding: 6px 4px;
                white-space: nowrap;
                min-width: 60px;
            }

            /* Enhanced chart title visibility for mobile */
            .chart-title {
                font-size: 12px !important;
                line-height: 1.2;
                margin-bottom: 10px;
                word-wrap: break-word;
                hyphens: auto;
                max-width: 100%;
                overflow-wrap: break-word;
            }

            /* Improved tooltip visibility */
            .chart-container canvas {
                max-width: 100%;
                height: auto !important;
            }
        }

        /* Low-Carbon Perception Intelligence Dashboard Styles */
        .low-carbon-charts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 25px 0;
        }

        .chart-container.low-carbon-compact {
            height: 380px;
            padding: 15px 15px 60px 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 71, 186, 0.1);
            border: 1px solid #e1e5e9;
        }

        .concern-alignment-table-container {
            overflow-x: auto;
            height: calc(100% - 40px);
            border-radius: 6px;
            border: 1px solid #e1e5e9;
        }

        .concern-alignment-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 10px;
            height: 100%;
        }

        .concern-alignment-table th {
            background: #0047BA;
            color: white;
            padding: 8px 6px;
            text-align: center;
            font-weight: 600;
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .concern-alignment-table td {
            padding: 8px 6px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
            font-size: 9px;
            vertical-align: middle;
        }

        .concern-alignment-table tbody tr:hover {
            background: #f8f9fa;
        }

        .low-carbon-insights-panel {
            margin-top: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e1e5e9;
        }

        .insights-summary-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        .insight-summary-card {
            background: #ffffff;
            border: 1px solid #e1e5e9;
            border-radius: 6px;
            padding: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .insight-summary-card:hover {
            box-shadow: 0 4px 12px rgba(0, 71, 186, 0.08);
            border-color: #0047BA;
        }

        .insight-summary-card.critical {
            border-left: 4px solid #e74c3c;
        }

        .insight-summary-card.warning {
            border-left: 4px solid #f39c12;
        }

        .insight-summary-card.positive {
            border-left: 4px solid #27ae60;
        }

        .insight-summary-card.info {
            border-left: 4px solid #0047BA;
        }

        .insight-summary-title {
            color: #0047BA;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .insight-summary-content {
            color: #2c3e50;
            font-size: 12px;
            line-height: 1.4;
            font-weight: 500;
        }

        /* Mobile responsive for low-carbon dashboard */
        @media (max-width: 768px) {
            .low-carbon-charts-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .chart-container.low-carbon-compact {
                height: 280px;
                padding: 12px;
            }

            .insights-summary-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .insight-summary-card {
                padding: 12px;
            }

            .concern-alignment-table {
                font-size: 9px;
            }

            .concern-alignment-table th,
            .concern-alignment-table td {
                padding: 6px 4px;
            }
        }

        @media (max-width: 479px) {
            .low-carbon-charts-grid {
                gap: 12px;
                margin: 15px 0;
            }

            .chart-container.low-carbon-compact {
                height: 250px;
                padding: 10px;
            }

            .low-carbon-insights-panel {
                padding: 15px;
                margin-top: 20px;
            }

            .insights-summary-grid {
                gap: 10px;
            }

            .insight-summary-card {
                padding: 10px;
            }

            .insight-summary-title {
                font-size: 10px;
            }

            .insight-summary-content {
                font-size: 11px;
            }

            .concern-alignment-table {
                font-size: 8px;
            }

            .concern-alignment-table th,
            .concern-alignment-table td {
                padding: 4px 3px;
            }
        }
    </style>
</head>
<body>
    <div class="presentation-container">
        <!-- Cover Slide -->
        <div class="slide active">
            <div style="text-align: center; padding-top: 10vh;">
                <svg class="section-icon" style="width: 80px; height: 80px; margin-bottom: 30px;" viewBox="0 0 24 24">
                    <path d="M19,3H5C3.9,3 3,3.9 3,5V19C3,20.1 3.9,21 5,21H19C20.1,21 21,20.1 21,19V5C21,3.9 20.1,3 19,3M19,19H5V8H19V19Z"/>
                </svg>
                <h1 style="color: #0047BA; font-size: 42px; font-weight: 700; margin-bottom: 20px;">
                    Internal Quarterly Review
                </h1>
                <p style="color: #666; font-size: 24px; margin-bottom: 40px;">
                    Q1 2025 | North American Investors | Reputation Intelligence
                </p>
                    <div class="executive-summary">
                        <h4>North American Investor Intelligence</h4>
                        <p style="color: #555; font-size: 16px; line-height: 1.6; margin-bottom: 20px;">
                            Quarterly analysis focused specifically on establishing ADNOC as a credible low-carbon investment opportunity for institutional investors. Combines investor surveys, media analysis, and competitive benchmarking to deliver actionable insights for North American market penetration.
                        </p>
                    <div class="summary-grid">
                        <div class="summary-metric">
                            <div class="summary-value">74</div>
                            <div class="summary-label">Low-Carbon Credibility Score</div>
                        </div>
                        <div class="summary-metric">
                            <div class="summary-value">+23%</div>
                            <div class="summary-label">Clean Tech Investment Interest</div>
                        </div>
                        <div class="summary-metric">
                            <div class="summary-value">$1.54B</div>
                            <div class="summary-label">Total AUM Engaged</div>
                        </div>
                        <div class="summary-metric">
                            <div class="summary-value">68%</div>
                            <div class="summary-label">Execution vs. Ambition Preference</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 1: How are we performing with this audience? -->
        <div class="slide">
            <div class="slide-header">
                <div class="slide-number">Question 01</div>
                <h2 class="slide-title">What's our investor momentum on low-carbon transition?</h2>
                <p class="slide-subtitle">North American Capital Engagement & Trust Building | Q1 2025</p>
            </div>

            <div class="content-section">
                <!-- Investor Response Intelligence Dashboard -->
                <div class="campaign-dashboard-container">
                    <div class="dashboard-title">Investor Response Intelligence Dashboard</div>
                    
                    <!-- Executive Summary Cards -->
                    <div class="summary-cards-grid">
                        <div class="summary-card">
                            <div class="card-label">Low-Carbon Credibility</div>
                            <div class="card-value">74</div>
                            <div class="card-campaign">3rd of 4 vs Competitors</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-label">Reliability Leadership</div>
                            <div class="card-value">78</div>
                            <div class="card-campaign">2nd of 4 (Best Score)</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-label">Total AUM Engaged</div>
                            <div class="card-value">$1.54B</div>
                            <div class="card-campaign">127 Institutional Investors</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-label">Response Rate</div>
                            <div class="card-value">73%</div>
                            <div class="card-campaign">High Engagement Level</div>
                        </div>
                    </div>

                    <!-- Competitive Positioning Matrix -->
                    <div class="competitive-positioning-container">
                        <h3 class="section-title">
                            <svg class="section-icon" viewBox="0 0 24 24">
                                <path d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                            </svg>
                            Low-Carbon Credibility vs. Competitors (Investor Perception)
                        </h3>
                        <table class="competitive-table">
                            <thead>
                                <tr>
                                    <th>Low-Carbon Investment Criteria</th>
                                    <th>ADNOC</th>
                                    <th>Saudi Aramco</th>
                                    <th>Shell</th>
                                    <th>TotalEnergies</th>
                                    <th>Investor Preference Rank</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Net Zero Execution Credibility</td>
                                    <td class="score-cell">74</td>
                                    <td>68</td>
                                    <td class="score-leading">80</td>
                                    <td>76</td>
                                    <td>3rd of 4</td>
                                </tr>
                                <tr>
                                    <td>Clean Tech Innovation Pipeline</td>
                                    <td class="score-cell">70</td>
                                    <td>62</td>
                                    <td class="score-leading">77</td>
                                    <td>75</td>
                                    <td>3rd of 4</td>
                                </tr>
                                <tr>
                                    <td>ESG Transparency & Disclosure</td>
                                    <td class="score-cell">69</td>
                                    <td class="score-lagging">60</td>
                                    <td class="score-leading">75</td>
                                    <td>72</td>
                                    <td>3rd of 4</td>
                                </tr>
                                <tr>
                                    <td>Energy Transition Reliability</td>
                                    <td class="score-cell score-leading">78</td>
                                    <td class="score-leading">80</td>
                                    <td>70</td>
                                    <td>74</td>
                                    <td>2nd of 4</td>
                                </tr>
                                <tr>
                                    <td>Global Standards Alignment</td>
                                    <td class="score-cell">72</td>
                                    <td>66</td>
                                    <td class="score-leading">78</td>
                                    <td>75</td>
                                    <td>3rd of 4</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <div class="methodology-note">
                            <p><strong>Note:</strong> Survey methodology: 127 North American institutional investors representing $8.4B AUM (Jan 15 - Mar 20, 2025, 73% response rate). Scores calculated on 0-100 scale with ±3.2 confidence interval, p<0.05 statistical significance.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="content-section">
                <!-- Performance Tracking Intelligence Dashboard -->
                <div class="campaign-dashboard-container">
                    <div class="dashboard-title">Performance Tracking Intelligence Dashboard</div>
                    
                    <!-- Performance Charts Column -->
                    <div class="charts-column">
                        <div class="chart-container">
                            <div class="chart-title">Investor Perception Score Changes | Q4 2024 → Q1 2025</div>
                            <canvas id="investorPerceptionChart" width="400" height="300"></canvas>
                        </div>
                        <div class="chart-container">
                            <div class="chart-title">Key ESG & Investment Metrics Progression | Q2 2024 - Q1 2025</div>
                            <canvas id="kpiTrendChart" width="400" height="300"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <div class="content-section">
                <!-- North American Stakeholder Engagement Dashboard -->
                <div class="campaign-dashboard-container">
                    <div class="dashboard-title">North American Stakeholder Engagement Dashboard</div>
                    
                    <!-- Stakeholder Engagement Charts Row -->
                    <div class="charts-row">
                        <div class="chart-container compact">
                            <div class="chart-title">Strategic Meetings by Center</div>
                            <canvas id="stakeholderEngagementChart" width="400" height="300px"></canvas>
                        </div>
                        <div class="chart-container compact">
                            <div class="chart-title">Investment Interest by Segment</div>
                            <canvas id="segmentationChart" width="400" height="300"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <div class="content-section">
                <div class="analysis-grid">
                    <div class="analysis-card positive">
                        <div class="card-title positive">Unique Investor Reactions</div>
                        <ul class="insights-list">
                            <li>Institutional appetite: 78% express confidence in UAE energy transition stability</li>
                            <li>Regional advantage: "UAE political stability" cited as key differentiator vs competitors</li>
                            <li>Investment thesis validation: Low-carbon positioning resonates with 89% of ESG mandates</li>
                            <li>Portfolio consideration: Active due diligence processes initiated across 4 financial centers</li>
                        </ul>
                    </div>
                    <div class="analysis-card warning">
                        <div class="card-title warning">Investor Concerns Identified</div>
                        <ul class="insights-list">
                            <li>Execution timeline skepticism: 67% want more concrete milestones</li>
                            <li>Third-party validation gap: 58% seek independent ESG verification</li>
                            <li>Competitive positioning: "Still behind Shell/Total on innovation"</li>
                            <li>Portfolio inclusion barriers: Limited clean tech track record cited</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="content-section">
                <!-- Low-Carbon Perception Intelligence Dashboard -->
                <div class="campaign-dashboard-container">
                    <div class="dashboard-title">Low-Carbon Topic Intelligence Analysis</div>
                    
                    <!-- Compact 2x2 Chart Grid -->
                    <div class="low-carbon-charts-grid">
                        <div class="chart-container low-carbon-compact">
                            <div class="chart-title">Stakeholder Perception Breakdown</div>
                            <canvas id="stakeholderPerceptionChart" width="400" height="300"></canvas>
                        </div>
                        <div class="chart-container low-carbon-compact">
                            <div class="chart-title">Media vs Stakeholder Negative Gap</div>
                            <canvas id="mediaNegativeGapChart" width="400" height="300"></canvas>
                        </div>
                        <div class="chart-container low-carbon-compact">
                            <div class="chart-title">Media Coverage Volume Analysis</div>
                            <canvas id="mediaCoverageVolumeChart" width="400" height="300"></canvas>
                        </div>
                        <div class="chart-container low-carbon-compact" style="padding: 15px;">
                            <div class="chart-title">Concern Alignment Summary</div>
                            <div class="concern-alignment-table-container">
                                <table id="concernAlignmentTable" class="concern-alignment-table">
                                    <thead>
                                        <tr>
                                            <th>Topic</th>
                                            <th>Media Concern</th>
                                            <th>Stakeholder Concern</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="concernAlignmentTableBody">
                                        <!-- Table rows will be populated by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Strategic Insights Panel -->
                    <div class="low-carbon-insights-panel">
                        <h5 style="color: #0047BA; font-size: 12px; font-weight: 700; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 0.5px;">Strategic Intelligence Summary</h5>
                        <div class="insights-summary-grid">
                            <div class="insight-summary-card critical">
                                <div class="insight-summary-title">
                                    <svg class="status-icon" width="16" height="16" viewBox="0 0 24 24" fill="#e74c3c">
                                        <circle cx="12" cy="12" r="10" fill="#e74c3c"/>
                                        <path d="M15 9L9 15M9 9L15 15" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                    </svg>
                                    IMMEDIATE ACTION
                                </div>
                                <div class="insight-summary-content">Net Zero: Address greenwashing perception gap | Innovation: Prove scalability beyond pilots</div>
                            </div>
                            <div class="insight-summary-card warning">
                                <div class="insight-summary-title">
                                    <svg class="status-icon" width="16" height="16" viewBox="0 0 24 24" fill="#f39c12">
                                        <circle cx="12" cy="12" r="10" fill="#f39c12"/>
                                        <path d="M12 8V12M12 16H12.01" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                    </svg>
                                    STRATEGIC MONITORING
                                </div>
                                <div class="insight-summary-content">Hydrogen: Align ROI messaging | Renewables: Address grid integration concerns</div>
                            </div>
                            <div class="insight-summary-card positive">
                                <div class="insight-summary-title">
                                    <svg class="status-icon" width="16" height="16" viewBox="0 0 24 24" fill="#27ae60">
                                        <circle cx="12" cy="12" r="10" fill="#27ae60"/>
                                        <path d="M9 12L11 14L15 10" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    MAINTAIN MOMENTUM
                                </div>
                                <div class="insight-summary-content">CCS: Continue timeline transparency | Green Finance: Leverage verification alignment</div>
                            </div>
                            <div class="insight-summary-card info">
                                <div class="insight-summary-title">
                                    <svg class="status-icon" width="16" height="16" viewBox="0 0 24 24" fill="#0047BA">
                                        <rect x="3" y="3" width="18" height="18" rx="2" fill="#0047BA"/>
                                        <path d="M9 9H15M9 13H15M9 17H13" stroke="white" stroke-width="1.5" stroke-linecap="round"/>
                                    </svg>
                                    KEY METRICS
                                </div>
                                <div class="insight-summary-content">67% topics misaligned | $2.1B AUM perception risk | 3 high-priority actions</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="content-section">
                <div class="executive-insights-container">
                    <h4 style="color: #0047BA; font-size: 16px; font-weight: 600; margin-bottom: 25px; text-transform: uppercase; letter-spacing: 0.5px;">Investor Reaction Insights</h4>
                    
                    <div class="insights-grid">
                        <div class="secondary-insight-card">
                            <div class="secondary-insight-header">
                                <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                    <path fill="#0047BA" d="M19,5V19H5V5H19M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M13,17V15H18V17H13M9,17V15H11V17H9M13,13V11H18V13H13M9,13V11H11V13H9M13,9V7H18V9H13M9,9V7H11V9H9Z"/>
                                </svg>
                                <div class="secondary-insight-title">COMPETITIVE POSITIONING BREAKTHROUGH</div>
                                <div class="secondary-insight-metric">2nd of 4</div>
                            </div>
                            <div class="secondary-insight-content">
                                <div class="secondary-insight-description">ADNOC ranks 2nd of 4 on Energy Transition Reliability (78 vs Shell's 70), demonstrating investor confidence in execution capability over innovation promises</div>
                                <div class="secondary-insight-impacts">
                                    <div class="secondary-impact-item">
                                        <svg class="impact-icon" width="12" height="12" viewBox="0 0 24 24" fill="#0047BA" style="margin-right: 8px; vertical-align: middle;">
                                            <path d="M4 12L20 12M20 12L14 6M20 12L14 18"/>
                                        </svg>
                                        Execution advantage: Outperforming Shell on reliability while maintaining lead over Saudi Aramco across all metrics
                                    </div>
                                    <div class="secondary-impact-item">
                                        <svg class="impact-icon" width="12" height="12" viewBox="0 0 24 24" fill="#0047BA" style="margin-right: 8px; vertical-align: middle;">
                                            <path d="M4 12L20 12M20 12L14 6M20 12L14 18"/>
                                        </svg>
                                        Strategic positioning: Investors value proven execution over ambitious innovation claims
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="secondary-insight-card">
                            <div class="secondary-insight-header">
                                <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                    <path fill="#0047BA" d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                                </svg>
                                <div class="secondary-insight-title">PERCEPTION MOMENTUM ACCELERATION</div>
                                <div class="secondary-insight-metric">+13.1%</div>
                            </div>
                            <div class="secondary-insight-content">
                                <div class="secondary-insight-description">All 5 investor perception attributes improved Q4→Q1, with ESG Transparency leading at +13.1% growth, directly addressing key investor concerns</div>
                                <div class="secondary-insight-impacts">
                                    <div class="secondary-impact-item">→ Comprehensive improvement: 100% positive movement across credibility, innovation, transparency, reliability, and standards</div>
                                    <div class="secondary-impact-item">→ Transparency breakthrough: Largest gain (+13.1%) addresses primary investor skepticism area</div>
                                </div>
                            </div>
                        </div>

                        <div class="secondary-insight-card">
                            <div class="secondary-insight-header">
                                <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                    <path fill="#0047BA" d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"/>
                                </svg>
                                <div class="secondary-insight-title">SEGMENT PRIORITIZATION SUCCESS</div>
                                <div class="secondary-insight-metric">$420M</div>
                            </div>
                            <div class="secondary-insight-content">
                                <div class="secondary-insight-description">ESG-Focused Funds show 89% interest with 94% follow-up rate representing $420M opportunity, while Canadian Pension Funds demonstrate highest growth (+18%)</div>
                                <div class="secondary-insight-impacts">
                                    <div class="secondary-impact-item">→ Priority segment validation: ESG-Focused Funds deliver highest conversion rates and largest AUM opportunity</div>
                                    <div class="secondary-impact-item">→ Emerging opportunity: Canadian Pension Funds show strongest growth momentum (+18%) indicating market expansion potential</div>
                                </div>
                            </div>
                        </div>

                        <div class="secondary-insight-card">
                            <div class="secondary-insight-header">
                                <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                    <path fill="#0047BA" d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                                </svg>
                                <div class="secondary-insight-title">QUARTERLY PERFORMANCE VALIDATION</div>
                                <div class="secondary-insight-metric">+52.9%</div>
                            </div>
                            <div class="secondary-insight-content">
                                <div class="secondary-insight-description">ESG Trust Score climbed from 68→78 (+14.7%) with Campaign ROI improving 1.7x→2.6x, proving low-carbon positioning drives measurable investor value</div>
                                <div class="secondary-insight-impacts">
                                    <div class="secondary-impact-item">→ Trust building success: Consistent quarterly progression demonstrates sustained momentum in credibility building</div>
                                    <div class="secondary-impact-item">→ ROI validation: +52.9% campaign ROI improvement proves low-carbon messaging drives tangible business results</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="supporting-insights">
                        <div class="secondary-insights-grid">
                            <div class="secondary-insight-card">
                                <div class="secondary-insight-header">
                                    <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                        <path fill="#0047BA" d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"/>
                                    </svg>
                                    <div class="secondary-insight-title">NORTH AMERICAN PENETRATION ACHIEVED</div>
                                    <div class="secondary-insight-metric">67%</div>
                                </div>
                                <div class="secondary-insight-content">
                                    <div class="secondary-insight-description">13 strategic engagements across 4 key financial centers achieved 67% follow-up rate</div>
                                    <div class="secondary-insight-impacts">
                                        <div class="secondary-impact-item">→ Pipeline impact: $2.8B AUM actively considering ADNOC inclusion</div>
                                        <div class="secondary-impact-item">→ Geographic expansion: Strong interest signals across all target markets</div>
                                    </div>
                                </div>
                            </div>

                            <div class="secondary-insight-card">
                                <div class="secondary-insight-header">
                                    <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                        <path fill="#0047BA" d="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z"/>
                                    </svg>
                                    <div class="secondary-insight-title">SOVEREIGN WEALTH BREAKTHROUGH</div>
                                    <div class="secondary-insight-metric">$180M</div>
                                </div>
                                <div class="secondary-insight-content">
                                    <div class="secondary-insight-description">Toronto discussions activated $180M sovereign wealth consideration for ESG mandates</div>
                                    <div class="secondary-insight-impacts">
                                        <div class="secondary-impact-item">→ Strategic positioning: Clean energy transition narrative resonated strongly</div>
                                        <div class="secondary-impact-item">→ Competitive advantage: First-mover advantage in Canadian ESG mandates</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Slide 2: Integrated Insights Across Channels -->
        <div class="slide">
            <div class="slide-header">
                <div class="slide-number">Question 02</div>
                <h2 class="slide-title">What's our messaging performance and current sentiment?</h2>
                <p class="slide-subtitle">North American Media & Channel Performance | Q1 2025</p>
            </div>

            <div class="content-section">
                <h3 class="section-title">
                    <svg class="section-icon" viewBox="0 0 24 24">
                        <path d="M12,2C6.48,2 2,6.48 2,12C2,17.52 6.48,22 12,22C17.52,22 22,17.52 22,12C22,6.48 17.52,2 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M16.59,7.58L10,14.17L7.41,11.59L6,13L10,17L18,9L16.59,7.58Z"/>
                    </svg>
                    Current Sentiment Overview
                </h3>
                <div class="kpi-cards-grid">
                    <div class="kpi-card positive">
                        <div class="kpi-value">73%</div>
                        <div class="kpi-label">Overall Positive Sentiment</div>
                        <div class="kpi-context">+15% vs Q4 2024</div>
                    </div>
                    <div class="kpi-card info">
                        <div class="kpi-value">+18%</div>
                        <div class="kpi-label">vs Sector Average</div>
                        <div class="kpi-context">Outperforming peers</div>
                    </div>
                    <div class="kpi-card positive">
                        <div class="kpi-value">2.1x</div>
                        <div class="kpi-label">vs Saudi Aramco Coverage</div>
                        <div class="kpi-context">Competitive advantage</div>
                    </div>
                    <div class="kpi-card warning">
                        <div class="kpi-value">16%</div>
                        <div class="kpi-label">Negative Sentiment</div>
                        <div class="kpi-context">Down from 28% in Q4</div>
                    </div>
                </div>
            </div>

            <div class="content-section">
                <h3 class="section-title">
                    <svg class="section-icon" viewBox="0 0 24 24">
                        <path d="M3,3H21A2,2 0 0,1 23,5V19A2,2 0 0,1 21,21H3A2,2 0 0,1 1,19V5A2,2 0 0,1 3,3M3,5V19H21V5H3M5,7H19V9H5V7M5,11H19V13H5V11M5,15H19V17H5V15Z"/>
                    </svg>
                    Integrated Campaign Analytics
                </h3>
                <!-- Campaign Performance Hybrid Dashboard -->
                <div class="campaign-dashboard-container">
                    <div class="dashboard-title">Campaign Performance Analysis Dashboard</div>
                    
                    <!-- Summary Cards -->
                    <div class="summary-cards-grid">
                        <div class="summary-card">
                            <div class="card-label">Highest Impressions</div>
                            <div class="card-value" id="topImpressions">5.2M</div>
                            <div class="card-campaign" id="topImpressionsCampaign">Bloomberg ESG Summit</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-label">Best CTR</div>
                            <div class="card-value" id="topCTR">3.2%</div>
                            <div class="card-campaign" id="topCTRCampaign">YouTube Clean Tech</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-label">Highest Brand Uplift</div>
                            <div class="card-value" id="topBrandUplift">1.9x</div>
                            <div class="card-campaign" id="topBrandUpliftCampaign">Harvard Business Review</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-label">Best Engagement</div>
                            <div class="card-value" id="topEngagement">6.1%</div>
                            <div class="card-campaign" id="topEngagementCampaign">YouTube Clean Tech</div>
                        </div>
                    </div>

                    <!-- Metric Toggle Buttons -->
                    <div class="metric-toggles">
                        <button class="metric-toggle active" data-metric="impressions">Impressions</button>
                        <button class="metric-toggle" data-metric="ctr">CTR (%)</button>
                        <button class="metric-toggle" data-metric="brandUplift">Brand Uplift</button>
                        <button class="metric-toggle" data-metric="engagement">Engagement (%)</button>
                        <button class="metric-toggle" data-metric="costPerClick">Cost Per Click</button>
                        <button class="metric-toggle" data-metric="sentiment">Sentiment Score</button>
                        <button class="metric-toggle" data-metric="leads">Lead Generation</button>
                    </div>

                    <!-- Interactive Chart -->
                    <div class="interactive-chart-container">
                        <canvas id="campaignDashboardChart" width="800" height="300"></canvas>
                    </div>

                </div>


                <!-- Media Penetration Metrics -->
                <div class="kpi-cards-grid">
                    <div class="kpi-card positive">
                        <div class="kpi-value">183</div>
                        <div class="kpi-label">Total Articles Published</div>
                        <div class="kpi-context">Q1 2025 coverage</div>
                    </div>
                    <div class="kpi-card info">
                        <div class="kpi-value">108</div>
                        <div class="kpi-label">Tier-1 Penetration</div>
                        <div class="kpi-context">Premium outlet articles</div>
                    </div>
                    <div class="kpi-card positive">
                        <div class="kpi-value">73%</div>
                        <div class="kpi-label">Average Sentiment</div>
                        <div class="kpi-context">Across all coverage</div>
                    </div>
                    <div class="kpi-card info">
                        <div class="kpi-value">1.4x</div>
                        <div class="kpi-label">vs Shell Media Volume</div>
                        <div class="kpi-context">Coverage advantage</div>
                    </div>
                </div>

            </div>

            <div class="content-section">
                <!-- Media Performance Analysis Dashboard -->
                <div class="campaign-dashboard-container">
                    <div class="dashboard-title">Media Performance Analysis Dashboard</div>
                    
                    <!-- Summary Cards -->
                    <div class="summary-cards-grid">
                        <div class="summary-card">
                            <div class="card-label">Highest SOV</div>
                            <div class="card-value" id="topSOV">53.5%</div>
                            <div class="card-campaign" id="topSOVOutlet">Tier 1 Media</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-label">Best Sentiment</div>
                            <div class="card-value" id="topSentiment">76%</div>
                            <div class="card-campaign" id="topSentimentOutlet">Bloomberg</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-label">Most Mentions</div>
                            <div class="card-value" id="topMentions">41</div>
                            <div class="card-campaign" id="topMentionsOutlet">Bloomberg</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-label">Top Tier 1</div>
                            <div class="card-value" id="topTier1">108</div>
                            <div class="card-campaign" id="topTier1Campaign">Total Mentions</div>
                        </div>
                    </div>

                    <!-- Metric Toggle Buttons -->
                    <div class="metric-toggles">
                        <button class="metric-toggle active" data-metric="sov">SOV %</button>
                        <button class="metric-toggle" data-metric="sentiment">Sentiment Score</button>
                        <button class="metric-toggle" data-metric="mentions">Mention Volume</button>
                        <button class="metric-toggle" data-metric="tier">Tier Performance</button>
                        <button class="metric-toggle" data-metric="theme">Theme Relevance</button>
                    </div>

                    <!-- Interactive Chart -->
                    <div class="interactive-chart-container">
                        <canvas id="mediaDashboardChart" width="800" height="300"></canvas>
                    </div>

                    <!-- Media Analysis Charts Row -->
                    <div class="remaining-charts-row" style="grid-template-columns: 1fr 1fr;">
                        <div class="chart-container mini">
                            <div class="chart-title">Coverage by Media Tier</div>
                            <canvas id="mediaTierChart" width="300" height="200"></canvas>
                        </div>
                        <div class="chart-container mini" style="padding: 15px;">
                            <div class="chart-title">Media Outlet Performance Analysis</div>
                            <div class="media-outlet-table-container">
                                <table id="mediaOutletTable" class="media-outlet-table">
                                    <thead>
                                        <tr>
                                            <th class="sortable" data-sort="outlet">Outlet</th>
                                            <th class="sortable" data-sort="tier">Tier</th>
                                            <th class="sortable" data-sort="mentions">Mentions</th>
                                            <th class="sortable" data-sort="positive">Positive %</th>
                                            <th class="sortable" data-sort="theme">Theme</th>
                                            <th class="sortable" data-sort="status">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="mediaOutletTableBody">
                                        <!-- Table rows will be populated by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="content-section">
                <div class="executive-insights-container">
                    <h4 style="color: #0047BA; font-size: 16px; font-weight: 600; margin-bottom: 25px; text-transform: uppercase; letter-spacing: 0.5px;">Executive Question Responses</h4>
                    
                    <div class="insights-grid">
                        <div class="secondary-insight-card">
                            <div class="secondary-insight-header">
                                <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                    <path fill="#27ae60" d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"/>
                                </svg>
                                <div class="secondary-insight-title">IS OUR MESSAGING WORKING? → YES</div>
                                <div class="secondary-insight-metric">1.9x</div>
                            </div>
                            <div class="secondary-insight-content">
                                <div class="secondary-insight-description">Harvard Business Review achieved highest brand uplift (1.9x) while Bloomberg delivered 5.2M impressions with 1.8x uplift, proving premium messaging drives measurable impact</div>
                                <div class="secondary-insight-impacts">
                                    <div class="secondary-impact-item">→ Quality messaging validation: Premium outlets generate superior brand uplift results</div>
                                    <div class="secondary-impact-item">→ Scale + impact: Bloomberg combines massive reach (5.2M) with strong brand performance (1.8x)</div>
                                </div>
                            </div>
                        </div>

                        <div class="secondary-insight-card">
                            <div class="secondary-insight-header">
                                <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                    <path fill="#27ae60" d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                                </svg>
                                <div class="secondary-insight-title">CHANNEL OPTIMIZATION WORKING? → YES</div>
                                <div class="secondary-insight-metric">+58%</div>
                            </div>
                            <div class="secondary-insight-content">
                                <div class="secondary-insight-description">LinkedIn ESG delivered +58% above-benchmark performance while YouTube Clean Tech achieved 6.1% engagement, demonstrating tailored messaging strategies outperform industry standards</div>
                                <div class="secondary-insight-impacts">
                                    <div class="secondary-impact-item">→ Platform-specific success: Each channel optimized for its unique audience and format</div>
                                    <div class="secondary-impact-item">→ Benchmark superiority: Consistently exceeding industry performance standards across platforms</div>
                                </div>
                            </div>
                        </div>

                        <div class="secondary-insight-card">
                            <div class="secondary-insight-header">
                                <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                    <path fill="#0047BA" d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"/>
                                </svg>
                                <div class="secondary-insight-title">CURRENT SENTIMENT STATUS → POSITIVE</div>
                                <div class="secondary-insight-metric">73%</div>
                            </div>
                            <div class="secondary-insight-content">
                                <div class="secondary-insight-description">73% positive sentiment (+15% vs Q4 2024) with negative sentiment declining from 28% to 16%, demonstrating strong upward momentum and sustained improvement</div>
                                <div class="secondary-insight-impacts">
                                    <div class="secondary-impact-item">→ Positive trajectory: Consistent quarterly improvement in sentiment metrics</div>
                                    <div class="secondary-impact-item">→ Risk reduction: 43% decrease in negative sentiment shows effective reputation management</div>
                                </div>
                            </div>
                        </div>

                        <div class="secondary-insight-card">
                            <div class="secondary-insight-header">
                                <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                    <path fill="#0047BA" d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                                </svg>
                                <div class="secondary-insight-title">COMPETITIVE SENTIMENT → LEADING</div>
                                <div class="secondary-insight-metric">+18%</div>
                            </div>
                            <div class="secondary-insight-content">
                                <div class="secondary-insight-description">+18% vs sector average sentiment with 2.1x coverage advantage vs Saudi Aramco and 1.4x media volume vs Shell, establishing clear competitive sentiment leadership</div>
                                <div class="secondary-insight-impacts">
                                    <div class="secondary-impact-item">→ Sector outperformance: Significantly above industry average sentiment scores</div>
                                    <div class="secondary-impact-item">→ Multi-competitor advantage: Leading vs both regional (Aramco) and international (Shell) peers</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="supporting-insights">
                        <div class="secondary-insights-grid">
                            <div class="secondary-insight-card">
                                <div class="secondary-insight-header">
                                    <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                        <path fill="#0047BA" d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                                    </svg>
                                    <div class="secondary-insight-title">EDITORIAL CREDIBILITY ESTABLISHED</div>
                                    <div class="secondary-insight-metric">+18%</div>
                                </div>
                                <div class="secondary-insight-content">
                                    <div class="secondary-insight-description">WSJ, Bloomberg, FT coverage exceeded industry benchmarks with 76% positive sentiment</div>
                                    <div class="secondary-insight-impacts">
                                        <div class="secondary-impact-item">→ Trust building: 18% improvement vs. sector average sentiment scores</div>
                                        <div class="secondary-impact-item">→ Investor influence: Tier-1 coverage drives 34% higher meeting requests</div>
                                    </div>
                                </div>
                            </div>

                            <div class="secondary-insight-card">
                                <div class="secondary-insight-header">
                                    <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                        <path fill="#0047BA" d="M19,5V19H5V5H19M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M13,17V15H18V17H13M9,17V15H11V17H9M13,13V11H18V13H13M9,13V11H11V13H9M13,9V7H18V9H13M9,9V7H11V9H9Z"/>
                                    </svg>
                                    <div class="secondary-insight-title">TIER-1 MEDIA DOMINANCE</div>
                                    <div class="secondary-insight-metric">73%</div>
                                </div>
                                <div class="secondary-insight-content">
                                    <div class="secondary-insight-description">108 premium outlet mentions achieved 73% positive sentiment across tier-1 publications</div>
                                    <div class="secondary-insight-impacts">
                                        <div class="secondary-impact-item">→ Strategic impact: $52M media value equivalent generated</div>
                                        <div class="secondary-impact-item">→ Competitive edge: 1.4x vs Shell</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 3: What's driving or damaging trust? -->
        <div class="slide">
            <div class="slide-header">
                <div class="slide-number">Question 03</div>
                <h2 class="slide-title">What trust risks need immediate action?</h2>
                <p class="slide-subtitle">North American Trust Vulnerability & Recovery Analysis | Q1 2025</p>
            </div>

            <div class="content-section">
                <h3 class="section-title">
                    <svg class="section-icon" viewBox="0 0 24 24">
                        <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"/>
                    </svg>
                    Trust Damagers - Risk Escalation Analysis
                </h3>
                
                <div class="chart-container trust-damagers-container">
                    <div class="chart-title">Forward Risk Indicators | Q4 2024 → Q1 2025 Escalation</div>
                    <canvas id="trustDamagersChart" width="400" height="300"></canvas>
                </div>
            </div>

            <div class="content-section">
                <h3 class="section-title">
                    <svg class="section-icon" viewBox="0 0 24 24">
                        <path d="M12 2L2 7V10C2 16 6 20.9 12 22C18 20.9 22 16 22 10V7L12 2Z"/>
                    </svg>
                    Trust Drivers - Stakeholder Recovery Patterns
                </h3>
                <div class="chart-container">
                    <div class="chart-title">Stakeholder Trust Score Trends | Q1 2024 - Q4 2024</div>
                    <canvas id="trustDriversChart" width="400" height="300"></canvas>
                </div>
            </div>

            <div class="content-section">
                <h3 class="section-title">
                    <svg class="section-icon" viewBox="0 0 24 24">
                        <path d="M9,12L11,14L22,3L21,2L11,12L7,8L2,13L3,14L9,12Z"/>
                    </svg>
                    Trust Impact Analysis | Q1 2025
                </h3>
                <div class="trust-analysis-grid">
                    <div class="chart-container trust-compact">
                        <div class="chart-title">Trust Impact Drivers | Q1 2025</div>
                        <canvas id="trustWaterfallChart" width="300" height="400"></canvas>
                    </div>
                    <div class="chart-container trust-compact">
                        <div class="chart-title">Crisis Event Pulse Check | Q1 2025</div>
                        <canvas id="crisisEventChart" width="300" height="400"></canvas>
                    </div>
                </div>
            </div>

            <div class="content-section">
                <div class="insights-grid">
                    <div class="secondary-insight-card">
                        <div class="secondary-insight-header">
                            <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                <path fill="#e74c3c" d="M12,2L13.09,8.26L22,9L13.09,9.74L12,16L10.91,9.74L2,9L10.91,8.26L12,2Z"/>
                            </svg>
                            <div class="secondary-insight-title">TRUST DAMAGERS - IMMEDIATE THREATS</div>
                            <div class="secondary-insight-metric">+72%</div>
                        </div>
                        <div class="secondary-insight-content">
                            <div class="secondary-insight-description">All 5 major trust risk factors escalated Q4→Q1, with carbon capture delays leading at +72% mention growth, signaling urgent intervention needed</div>
                            <div class="secondary-insight-impacts">
                                <div class="secondary-impact-item">
                                    <svg class="impact-icon" width="12" height="12" viewBox="0 0 24 24" fill="#e74c3c" style="margin-right: 8px; vertical-align: middle;">
                                        <path d="M12,2L13.09,8.26L22,9L13.09,9.74L12,16L10.91,9.74L2,9L10.91,8.26L12,2Z"/>
                                    </svg>
                                    Carbon capture delays: 18→31 mentions (+72% escalation) - HIGH PRIORITY
                                </div>
                                <div class="secondary-impact-item">
                                    <svg class="impact-icon" width="12" height="12" viewBox="0 0 24 24" fill="#e74c3c" style="margin-right: 8px; vertical-align: middle;">
                                        <path d="M12,2L13.09,8.26L22,9L13.09,9.74L12,16L10.91,9.74L2,9L10.91,8.26L12,2Z"/>
                                    </svg>
                                    Regional political uncertainty: 22→28 mentions (+27% increase) - HIGH PRIORITY
                                </div>
                                <div class="secondary-impact-item">
                                    <svg class="impact-icon" width="12" height="12" viewBox="0 0 24 24" fill="#f39c12" style="margin-right: 8px; vertical-align: middle;">
                                        <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"/>
                                    </svg>
                                    Greenwashing allegations: 12→27 mentions (+125% surge) - MEDIUM PRIORITY
                                </div>
                                <div class="secondary-impact-item">
                                    <svg class="impact-icon" width="12" height="12" viewBox="0 0 24 24" fill="#f39c12" style="margin-right: 8px; vertical-align: middle;">
                                        <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"/>
                                    </svg>
                                    ESG audit transparency: 9→18 mentions (+100% growth) - MEDIUM PRIORITY
                                </div>
                                <div class="secondary-impact-item">
                                    <svg class="impact-icon" width="12" height="12" viewBox="0 0 24 24" fill="#f39c12" style="margin-right: 8px; vertical-align: middle;">
                                        <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"/>
                                    </svg>
                                    Clean tech visibility gaps: 14→26 mentions (+86% rise) - MEDIUM PRIORITY
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="secondary-insight-card">
                        <div class="secondary-insight-header">
                            <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                <path fill="#27ae60" d="M12 2L2 7V10C2 16 6 20.9 12 22C18 20.9 22 16 22 10V7L12 2Z"/>
                            </svg>
                            <div class="secondary-insight-title">TRUST DRIVERS - RECOVERY MOMENTUM</div>
                            <div class="secondary-insight-metric">+21.8%</div>
                        </div>
                        <div class="secondary-insight-content">
                            <div class="secondary-insight-description">IOC relationships improved +21.8% and investor trust rebounded +15.3%, demonstrating ADNOC's ability to rebuild trust when focused</div>
                            <div class="secondary-insight-impacts">
                                <div class="secondary-impact-item">
                                    <svg class="impact-icon" width="12" height="12" viewBox="0 0 24 24" fill="#27ae60" style="margin-right: 8px; vertical-align: middle;">
                                        <path d="M12 2L2 7V10C2 16 6 20.9 12 22C18 20.9 22 16 22 10V7L12 2Z"/>
                                    </svg>
                                    Investor trust recovery: Q3 71.99 → Q4 83.03 (+15.3% rebound)
                                </div>
                                <div class="secondary-impact-item">
                                    <svg class="impact-icon" width="12" height="12" viewBox="0 0 24 24" fill="#27ae60" style="margin-right: 8px; vertical-align: middle;">
                                        <path d="M12 2L2 7V10C2 16 6 20.9 12 22C18 20.9 22 16 22 10V7L12 2Z"/>
                                    </svg>
                                    IOC relationship strength: Q2 76.15 → Q4 92.74 (+21.8% improvement)
                                </div>
                                <div class="secondary-impact-item">
                                    <svg class="impact-icon" width="12" height="12" viewBox="0 0 24 24" fill="#27ae60" style="margin-right: 8px; vertical-align: middle;">
                                        <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"/>
                                    </svg>
                                    Regulatory confidence: Sustained high performance (98.31 score)
                                </div>
                                <div class="secondary-impact-item">
                                    <svg class="impact-icon" width="12" height="12" viewBox="0 0 24 24" fill="#0047BA" style="margin-right: 8px; vertical-align: middle;">
                                        <path d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                                    </svg>
                                    Technology leadership: UN Hydrogen Strategy (+5 sentiment boost)
                                </div>
                                <div class="secondary-impact-item">
                                    <svg class="impact-icon" width="12" height="12" viewBox="0 0 24 24" fill="#0047BA" style="margin-right: 8px; vertical-align: middle;">
                                        <path d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                                    </svg>
                                    Innovation narrative: UAE Net Zero Update (+4 sentiment lift)
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="content-section">
                <div class="executive-insights-container">
                    <h4 style="color: #0047BA; font-size: 16px; font-weight: 600; margin-bottom: 25px; text-transform: uppercase; letter-spacing: 0.5px;">Trust Intelligence Executive Summary</h4>
                    
                    <div class="insights-grid">
                        <div class="secondary-insight-card">
                            <div class="secondary-insight-header">
                                <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                    <path fill="#e74c3c" d="M12,2L13.09,8.26L22,9L13.09,9.74L12,16L10.91,9.74L2,9L10.91,8.26L12,2Z"/>
                                </svg>
                                <div class="secondary-insight-title">TRUST VULNERABILITY ESCALATION</div>
                                <div class="secondary-insight-metric">+72%</div>
                            </div>
                            <div class="secondary-insight-content">
                                <div class="secondary-insight-description">All 5 major trust risk factors escalated Q4→Q1, with carbon capture delays leading at +72% mention growth, signaling urgent intervention needed</div>
                                <div class="secondary-insight-impacts">
                                    <div class="secondary-impact-item">→ Systemic risk: No trust damager improved, indicating broad-based reputation pressure</div>
                                    <div class="secondary-impact-item">→ Acceleration pattern: Risk mentions growing faster than positive narrative development</div>
                                </div>
                            </div>
                        </div>

                        <div class="secondary-insight-card">
                            <div class="secondary-insight-header">
                                <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                    <path fill="#27ae60" d="M12 2L2 7V10C2 16 6 20.9 12 22C18 20.9 22 16 22 10V7L12 2Z"/>
                                </svg>
                                <div class="secondary-insight-title">TRUST RECOVERY CAPABILITY PROVEN</div>
                                <div class="secondary-insight-metric">+21.8%</div>
                            </div>
                            <div class="secondary-insight-content">
                                <div class="secondary-insight-description">IOC relationships improved +21.8% and investor trust rebounded +15.3%, demonstrating ADNOC's ability to rebuild trust when focused</div>
                                <div class="secondary-insight-impacts">
                                    <div class="secondary-impact-item">→ Recovery speed: Trust can rebound within quarters with targeted interventions</div>
                                    <div class="secondary-impact-item">→ Stakeholder differentiation: Different groups respond to different trust-building approaches</div>
                                </div>
                            </div>
                        </div>

                        <div class="secondary-insight-card">
                            <div class="secondary-insight-header">
                                <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                    <path fill="#f39c12" d="M13,14C9.64,14 8.54,15.35 8.18,16.24C9.25,16.7 10.62,17 12,17C13.38,17 14.75,16.7 15.82,16.24C15.46,15.35 14.36,14 11,14H13M12,13C14.21,13 16,11.21 16,9C16,6.79 14.21,5 12,5C9.79,5 8,6.79 8,9C8,11.21 9.79,13 12,13Z"/>
                                </svg>
                                <div class="secondary-insight-title">EVENT SENSITIVITY QUANTIFIED</div>
                                <div class="secondary-insight-metric">-10</div>
                            </div>
                            <div class="secondary-insight-content">
                                <div class="secondary-insight-description">External events drive -10 to +5 sentiment swings with 37-120% media amplification, showing high trust volatility to external factors</div>
                                <div class="secondary-insight-impacts">
                                    <div class="secondary-impact-item">→ Crisis amplification: Negative events generate 2-3x more media coverage than positive ones</div>
                                    <div class="secondary-impact-item">→ Proactive opportunity: Positive events (UN Hydrogen) can drive meaningful trust gains</div>
                                </div>
                            </div>
                        </div>

                        <div class="secondary-insight-card">
                            <div class="secondary-insight-header">
                                <svg class="insight-icon" viewBox="0 0 24 24" width="18" height="18">
                                    <path fill="#0047BA" d="M19,5V19H5V5H19M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M13,17V15H18V17H13M9,17V15H11V17H9M13,13V11H18V13H13M9,13V11H11V13H9M13,9V7H18V9H13M9,9V7H11V9H9Z"/>
                                </svg>
                                <div class="secondary-insight-title">TRUST ACTION PRIORITIZATION</div>
                                <div class="secondary-insight-metric">3</div>
                            </div>
                            <div class="secondary-insight-content">
                                <div class="secondary-insight-description">3 high-priority trust interventions identified: carbon capture transparency, regional stability messaging, and independent ESG auditing</div>
                                <div class="secondary-insight-impacts">
                                    <div class="secondary-impact-item">→ Immediate impact potential: Addressing top 3 damagers could reduce 77 negative mentions</div>
                                    <div class="secondary-impact-item">→ Resource optimization: Focus on high-impact, manageable interventions first</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="supporting-metrics">
                        <div class="metrics-section">
                            <div class="metrics-header">
                                <svg class="metrics-icon" width="20" height="20" viewBox="0 0 24 24" fill="#e74c3c">
                                    <path d="M12,2L13.09,8.26L22,9L13.09,9.74L12,16L10.91,9.74L2,9L10.91,8.26L12,2Z"/>
                                </svg>
                                <h5>Trust Damager Escalation (Q4→Q1)</h5>
                                <div class="metrics-summary">5 Risk Factors</div>
                            </div>
                            <div class="metrics-grid">
                                <div class="metric-card critical">
                                    <div class="metric-label">Carbon Capture</div>
                                    <div class="metric-value">+72%</div>
                                    <div class="metric-status">Critical</div>
                                </div>
                                <div class="metric-card critical">
                                    <div class="metric-label">Greenwashing</div>
                                    <div class="metric-value">+125%</div>
                                    <div class="metric-status">Critical</div>
                                </div>
                                <div class="metric-card warning">
                                    <div class="metric-label">ESG Audits</div>
                                    <div class="metric-value">+100%</div>
                                    <div class="metric-status">High</div>
                                </div>
                                <div class="metric-card warning">
                                    <div class="metric-label">Clean Tech Visibility</div>
                                    <div class="metric-value">+86%</div>
                                    <div class="metric-status">High</div>
                                </div>
                                <div class="metric-card moderate">
                                    <div class="metric-label">Regional Uncertainty</div>
                                    <div class="metric-value">+27%</div>
                                    <div class="metric-status">Medium</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="metrics-section">
                            <div class="metrics-header">
                                <svg class="metrics-icon" width="20" height="20" viewBox="0 0 24 24" fill="#27ae60">
                                    <path d="M12 2L2 7V10C2 16 6 20.9 12 22C18 20.9 22 16 22 10V7L12 2Z"/>
                                </svg>
                                <h5>Trust Driver Performance (Quarterly)</h5>
                                <div class="metrics-summary">5 Recovery Metrics</div>
                            </div>
                            <div class="metrics-grid">
                                <div class="metric-card positive">
                                    <div class="metric-label">Investor Recovery</div>
                                    <div class="metric-value">+15.3%</div>
                                    <div class="metric-status">Strong</div>
                                </div>
                                <div class="metric-card positive">
                                    <div class="metric-label">IOC Relations</div>
                                    <div class="metric-value">+21.8%</div>
                                    <div class="metric-status">Excellent</div>
                                </div>
                                <div class="metric-card positive">
                                    <div class="metric-label">Regulatory Trust</div>
                                    <div class="metric-value">98.31</div>
                                    <div class="metric-status">Outstanding</div>
                                </div>
                                <div class="metric-card info">
                                    <div class="metric-label">Tech Leadership</div>
                                    <div class="metric-value">+5</div>
                                    <div class="metric-status">Sentiment</div>
                                </div>
                                <div class="metric-card info">
                                    <div class="metric-label">Innovation Narrative</div>
                                    <div class="metric-value">+4</div>
                                    <div class="metric-status">Sentiment</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="metrics-section">
                            <div class="metrics-header">
                                <svg class="metrics-icon" width="20" height="20" viewBox="0 0 24 24" fill="#f39c12">
                                    <path d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                                </svg>
                                <h5>Event Impact Range (Q1 2025)</h5>
                                <div class="metrics-summary">Volatility Analysis</div>
                            </div>
                            <div class="metrics-grid">
                                <div class="metric-card critical">
                                    <div class="metric-label">Worst Impact</div>
                                    <div class="metric-value">-10</div>
                                    <div class="metric-status">Sentiment</div>
                                </div>
                                <div class="metric-card positive">
                                    <div class="metric-label">Best Impact</div>
                                    <div class="metric-value">+5</div>
                                    <div class="metric-status">Sentiment</div>
                                </div>
                                <div class="metric-card warning">
                                    <div class="metric-label">Max Media Spike</div>
                                    <div class="metric-value">120%</div>
                                    <div class="metric-status">Coverage</div>
                                </div>
                                <div class="metric-card info">
                                    <div class="metric-label">Recovery Time</div>
                                    <div class="metric-value">1-2</div>
                                    <div class="metric-status">Quarters</div>
                                </div>
                                <div class="metric-card warning">
                                    <div class="metric-label">Trust Volatility</div>
                                    <div class="metric-value">High</div>
                                    <div class="metric-status">Risk Level</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Navigation -->
    <div class="navigation">
        <button class="nav-btn" id="prevBtn" onclick="changeSlide(-1)">Previous</button>
        <button class="nav-btn" id="nextBtn" onclick="changeSlide(1)">Next</button>
    </div>

    <!-- Slide Indicators -->
    <div class="slide-indicator">
        <div class="indicator-dot active" onclick="currentSlide(1)"></div>
        <div class="indicator-dot" onclick="currentSlide(2)"></div>
        <div class="indicator-dot" onclick="currentSlide(3)"></div>
        <div class="indicator-dot" onclick="currentSlide(4)"></div>
    </div>

    <script>
        let slideIndex = 1;
        const slides = document.querySelectorAll('.slide');
        const indicators = document.querySelectorAll('.indicator-dot');

        // Global responsive variables
        const isMobile = window.innerWidth < 480;
        const isTablet = window.innerWidth < 768;

        // Chart variables
        let segmentationChart = null;
        let messageResonanceChart = null;
        let contentFormatChart = null;
        let messageTestingChart = null;
        let trustDriverChart = null;
        let sentimentTrendChart = null;
        let trustComponentsChart = null;
        let priorityMatrixChart = null;
        let campaignPerformanceChart = null;
        let mediaSentimentChart = null;
        let stakeholderEngagementChart = null;
        let mediaTierChart = null;
        let kpiTrendChart = null;
        let investorPerceptionChart = null;

        // Embedded CSV Data - Q1 2025 Real Data
        const mediaOutletData = [
            {outlet: 'WSJ', tier: 'Tier 1', mentions: 32, positive: 72, theme: 'Hydrogen partnership'},
            {outlet: 'Bloomberg', tier: 'Tier 1', mentions: 41, positive: 76, theme: 'Net Zero leadership'},
            {outlet: 'Financial Times', tier: 'Tier 1', mentions: 35, positive: 70, theme: 'AI in energy'},
            {outlet: 'Reuters', tier: 'Tier 1', mentions: 28, positive: 66, theme: 'Policy stability'},
            {outlet: 'The Globe and Mail', tier: 'Tier 2', mentions: 26, positive: 61, theme: 'ESG disclosures'}
        ];

        const mediaTierSOVData = [
            {tier: 'Tier 1', adnocMentions: 108, peerMentions: 93, sovPercent: 53.5},
            {tier: 'Tier 2', adnocMentions: 54, peerMentions: 62, sovPercent: 46.5},
            {tier: 'Tier 3', adnocMentions: 21, peerMentions: 35, sovPercent: 37.5}
        ];

        // Helper function for responsive data display
        function getResponsiveOutletData() {
            const screenWidth = window.innerWidth;
            if (screenWidth < 480) {
                return mediaOutletData.slice(0, 3); // Top 3 on mobile
            } else if (screenWidth < 768) {
                return mediaOutletData.slice(0, 4); // Top 4 on tablet
            }
            return mediaOutletData; // All data on desktop
        }

        function showSlide(n) {
            if (n > slides.length) { slideIndex = 1; }
            if (n < 1) { slideIndex = slides.length; }
            
            slides.forEach(slide => slide.classList.remove('active'));
            indicators.forEach(indicator => indicator.classList.remove('active'));
            
            slides[slideIndex - 1].classList.add('active');
            indicators[slideIndex - 1].classList.add('active');
            
            // Update navigation buttons
            document.getElementById('prevBtn').disabled = slideIndex === 1;
            document.getElementById('nextBtn').disabled = slideIndex === slides.length;
            
            // Reset scroll position to top of page
            setTimeout(() => {
                window.scrollTo({
                    top: 0,
                    left: 0,
                    behavior: 'smooth'
                });
            }, 50);
        }

        function changeSlide(n) {
            slideIndex += n;
            showSlide(slideIndex);
        }

        function currentSlide(n) {
            slideIndex = n;
            showSlide(slideIndex);
        }

        // Create Enhanced North American Investor Segmentation Chart
        function createSegmentationChart() {
            const ctx = document.getElementById('segmentationChart');
            if (!ctx) return;

            if (segmentationChart) {
                segmentationChart.destroy();
            }

            const segmentData = [
                { segment: 'ESG-Focused Funds', interest: 89, followUp: 94, aum: '$420M', change: '+12%' },
                { segment: 'Canadian Pension Funds', interest: 85, followUp: 92, aum: '$180M', change: '+18%' },
                { segment: 'US Sovereign Wealth', interest: 84, followUp: 88, aum: '$650M', change: '+8%' },
                { segment: 'Traditional Institutional', interest: 67, followUp: 78, aum: '$290M', change: '+5%' }
            ];

            // Simplified responsive label handling - always show labels
            const isMobile = window.innerWidth < 480;
            const isTablet = window.innerWidth < 768;

            const responsiveLabels = segmentData.map(item => {
                if (isMobile) {
                    // Ultra-short for mobile
                    const shortLabels = {
                        'ESG-Focused Funds': 'ESG',
                        'Canadian Pension Funds': 'CAN',
                        'US Sovereign Wealth': 'US',
                        'Traditional Institutional': 'TRAD'
                    };
                    return shortLabels[item.segment] || 'ESG';
                } else if (isTablet) {
                    // Short for tablet
                    const tabletLabels = {
                        'ESG-Focused Funds': 'ESG',
                        'Canadian Pension Funds': 'CAN',
                        'US Sovereign Wealth': 'US',
                        'Traditional Institutional': 'TRAD'
                    };
                    return tabletLabels[item.segment] || 'ESG';
                }
                // Desktop labels - keep them short but readable
                const desktopLabels = {
                    'ESG-Focused Funds': 'ESG Funds',
                    'Canadian Pension Funds': 'CAN Pension',
                    'US Sovereign Wealth': 'US Sovereign',
                    'Traditional Institutional': 'Traditional'
                };
                return desktopLabels[item.segment] || 'ESG Funds';
            });

            const data = {
                labels: responsiveLabels,
                datasets: [{
                    label: 'Low-Carbon Investment Interest (%)',
                    data: segmentData.map(item => item.interest),
                    backgroundColor: '#27ae60',
                    borderWidth: 1,
                    borderRadius: 4,
                    borderColor: '#ffffff'
                }, {
                    label: 'Meeting Follow-up Rate (%)',
                    data: segmentData.map(item => item.followUp),
                    backgroundColor: '#0047BA',
                    borderWidth: 1,
                    borderRadius: 4,
                    borderColor: '#ffffff'
                }]
            };

            segmentationChart = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    layout: {
                        padding: {
                            left: 15,
                            right: 15,
                            top: 20,
                            bottom: isMobile ? 45 : 35
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                padding: isMobile ? 15 : 20,
                                font: {
                                    size: isMobile ? 10 : 12,
                                    weight: 'normal'
                                },
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#0047BA',
                            borderWidth: 1,
                            cornerRadius: 6,
                            displayColors: true,
                            callbacks: {
                                title: function(context) {
                                    return segmentData[context[0].dataIndex].segment;
                                },
                                label: function(context) {
                                    const segment = segmentData[context.dataIndex];
                                    const metric = context.datasetIndex === 0 ? 'Interest' : 'Follow-up Rate';
                                    return `${metric}: ${context.raw}%`;
                                },
                                afterBody: function(context) {
                                    const segment = segmentData[context[0].dataIndex];
                                    return [
                                        '',
                                        `AUM Engaged: ${segment.aum}`,
                                        `Q1 Growth: ${segment.change}`,
                                        '',
                                        'Strategic Priority: ' + (segment.interest >= 85 ? 'HIGH' : segment.interest >= 75 ? 'MEDIUM' : 'FOCUS AREA')
                                    ];
                                }
                            }
                        },
                        datalabels: {
                            display: true,
                            anchor: 'end',
                            align: 'top',
                            color: function(context) {
                                return context.datasetIndex === 0 ? '#27ae60' : '#0047BA';
                            },
                            font: {
                                size: isMobile ? 8 : 10,
                                weight: '600'
                            },
                            formatter: function(value, context) {
                                const datasetLabel = context.datasetIndex === 0 ? 'Interest' : 'Follow-up';
                                return `${datasetLabel}: ${value}%`;
                            },
                            offset: 4,
                            textStrokeColor: '#ffffff',
                            textStrokeWidth: 1
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                font: {
                                    size: isMobile ? 9 : 11,
                                    weight: 'normal'
                                },
                                maxRotation: isMobile ? 45 : 0,
                                minRotation: 0,
                                color: '#333',
                                padding: isMobile ? 8 : 12
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: !isMobile,
                                text: 'Performance Score (%)',
                                font: {
                                    size: isMobile ? 10 : 12,
                                    weight: 'normal'
                                },
                                color: '#0047BA'
                            },
                            ticks: {
                                font: {
                                    size: isMobile ? 9 : 11,
                                    weight: 'normal'
                                },
                                color: '#666',
                                stepSize: 20,
                                padding: isMobile ? 6 : 8
                            },
                            grid: {
                                color: 'rgba(0, 71, 186, 0.1)',
                                lineWidth: 1
                            }
                        }
                    }
                }
            });
        }

        // Create Message Resonance Chart
        function createMessageResonanceChart() {
            const ctx = document.getElementById('messageResonanceChart');
            if (!ctx) return;

            if (messageResonanceChart) {
                messageResonanceChart.destroy();
            }

            const data = {
                labels: ['AI Innovation', 'UAE Stability', 'Carbon Capture', 'Net Zero Ambition', 'Traditional Energy'],
                datasets: [{
                    label: 'Message Performance Score',
                    data: [92, 88, 76, 64, 52],
                    backgroundColor: [
                        '#28a745',  // AI Innovation (92) - High performing (green)
                        '#28a745',  // UAE Stability (88) - High performing (green)
                        '#ffc107',  // Carbon Capture (76) - Moderate (yellow)
                        '#fd7e14',  // Net Zero Ambition (64) - Below average (orange)
                        '#dc3545'   // Traditional Energy (52) - Underperforming (red)
                    ],
                    borderWidth: 0,
                    borderRadius: 4,
                    borderSkipped: false
                }]
            };

            messageResonanceChart = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    indexAxis: 'y',
                    layout: {
                        padding: {
                            left: 10,
                            right: 20,
                            top: 10,
                            bottom: 10
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return context[0].label;
                                },
                                label: function(context) {
                                    const score = context.raw;
                                    let performance = '';
                                    if (score >= 85) performance = 'High Performance';
                                    else if (score >= 70) performance = 'Good Performance';
                                    else if (score >= 60) performance = 'Moderate Performance';
                                    else performance = 'Needs Improvement';
                                    return `Score: ${score} (${performance})`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Performance Score (0-100)',
                                font: {
                                    size: 12
                                }
                            },
                            ticks: {
                                font: {
                                    size: 11
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        y: {
                            ticks: {
                                font: {
                                    size: 12,
                                    weight: '500'
                                }
                            },
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // Create Content Format Chart
        function createContentFormatChart() {
            const ctx = document.getElementById('contentFormatChart');
            if (!ctx) return;

            if (contentFormatChart) {
                contentFormatChart.destroy();
            }

            const data = {
                labels: ['Executive Commentary', 'Case Studies', 'Data Visualizations', 'Press Releases', 'White Papers'],
                datasets: [{
                    data: [85, 78, 72, 58, 45],
                    backgroundColor: ['#0047BA', '#1565C0', '#1976D2', '#42A5F5', '#90CAF9'],
                    borderWidth: 1
                }]
            };

            contentFormatChart = new Chart(ctx, {
                type: 'pie',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                fontSize: 10
                            }
                        }
                    }
                }
            });
        }

        // Create Message Testing Chart
        function createMessageTestingChart() {
            const ctx = document.getElementById('messageTestingChart');
            if (!ctx) return;

            if (messageTestingChart) {
                messageTestingChart.destroy();
            }

            const data = {
                labels: ['Jan', 'Feb', 'Mar'],
                datasets: [{
                    label: 'Execution Focus',
                    data: [65, 72, 78],
                    borderColor: '#28a745',
                    backgroundColor: 'rgba(40, 167, 69, 0.1)',
                    borderWidth: 3,
                    fill: true
                }, {
                    label: 'Ambition Focus',
                    data: [78, 71, 64],
                    borderColor: '#dc3545',
                    backgroundColor: 'rgba(220, 53, 69, 0.1)',
                    borderWidth: 3,
                    fill: true
                }]
            };

            messageTestingChart = new Chart(ctx, {
                type: 'line',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        // Create Trust Driver Chart
        function createTrustDriverChart() {
            const ctx = document.getElementById('trustDriverChart');
            if (!ctx) return;

            if (trustDriverChart) {
                trustDriverChart.destroy();
            }

            const data = {
                labels: ['Execution Credibility', 'Third-party Validation', 'Transparency', 'Innovation Leadership', 'Regional Stability', 'ESG Disclosure'],
                datasets: [{
                    label: 'Trust Impact Score',
                    data: [92, 88, 84, 82, 78, 76],
                    backgroundColor: 'rgba(0, 71, 186, 0.2)',
                    borderColor: '#0047BA',
                    borderWidth: 3,
                    pointBackgroundColor: '#0047BA',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: '#0047BA'
                }]
            };

            trustDriverChart = new Chart(ctx, {
                type: 'radar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20
                            }
                        }
                    }
                }
            });
        }

        // Create Sentiment Trend Chart
        function createSentimentTrendChart() {
            const ctx = document.getElementById('sentimentTrendChart');
            if (!ctx) return;

            if (sentimentTrendChart) {
                sentimentTrendChart.destroy();
            }

            const data = {
                labels: ['Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar'],
                datasets: [{
                    label: 'Positive Sentiment %',
                    data: [58, 61, 61, 67, 70, 73],
                    borderColor: '#28a745',
                    backgroundColor: 'rgba(40, 167, 69, 0.1)',
                    borderWidth: 3,
                    fill: true
                }, {
                    label: 'Negative Sentiment %',
                    data: [28, 25, 26, 22, 19, 16],
                    borderColor: '#dc3545',
                    backgroundColor: 'rgba(220, 53, 69, 0.1)',
                    borderWidth: 3,
                    fill: true
                }]
            };

            sentimentTrendChart = new Chart(ctx, {
                type: 'line',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 80
                        }
                    }
                }
            });
        }

        // Create Trust Components Chart
        function createTrustComponentsChart() {
            const ctx = document.getElementById('trustComponentsChart');
            if (!ctx) return;

            if (trustComponentsChart) {
                trustComponentsChart.destroy();
            }

            const data = {
                labels: ['Net Zero Credibility', 'Innovation', 'Transparency', 'Reliability', 'Standards Alignment'],
                datasets: [{
                    data: [74, 70, 69, 78, 72],
                    backgroundColor: ['#0047BA', '#1565C0', '#1976D2', '#42A5F5', '#90CAF9'],
                    borderWidth: 2,
                    borderColor: '#fff'
                }]
            };

            trustComponentsChart = new Chart(ctx, {
                type: 'doughnut',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                fontSize: 10
                            }
                        }
                    }
                }
            });
        }

        // Create Priority Matrix Chart
        function createPriorityMatrixChart() {
            const ctx = document.getElementById('priorityMatrixChart');
            if (!ctx) return;

            if (priorityMatrixChart) {
                priorityMatrixChart.destroy();
            }

            const data = {
                datasets: [{
                    label: 'Strategic Actions',
                    data: [
                        { x: 2, y: 9, r: 20, action: 'Carbon Capture Communication' },
                        { x: 3, y: 8, r: 18, action: 'Third-party ESG Audit' },
                        { x: 4, y: 7, r: 15, action: 'AI Innovation Messaging' },
                        { x: 6, y: 6, r: 12, action: 'Competitive Positioning' }
                    ],
                    backgroundColor: ['#dc3545', '#dc3545', '#ffc107', '#0047BA'],
                    borderColor: ['#dc3545', '#dc3545', '#ffc107', '#0047BA'],
                    borderWidth: 2
                }]
            };

            priorityMatrixChart = new Chart(ctx, {
                type: 'bubble',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                padding: isMobile ? 15 : 20,
                                font: {
                                    size: isMobile ? 11 : 13,
                                    weight: '600',
                                    family: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
                                },
                                color: '#2c3e50',
                                usePointStyle: true,
                                pointStyle: 'circle',
                                boxWidth: isMobile ? 12 : 14,
                                boxHeight: isMobile ? 12 : 14
                            }
                        },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    const fullNames = ['Carbon Capture Communication', 'Third-party ESG Audit', 'AI Innovation Messaging', 'Competitive Positioning'];
                                    return fullNames[context[0].dataIndex];
                                },
                                label: function(context) {
                                    const impact = context.raw.y > 7 ? 'High Impact' : 'Medium Impact';
                                    const effort = context.raw.x > 5 ? 'High Effort' : 'Low Effort';
                                    return [`${impact}, ${effort}`];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Implementation Effort'
                            },
                            min: 0,
                            max: 10
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Strategic Impact'
                            },
                            min: 0,
                            max: 10
                        }
                    }
                }
            });
        }

        // Create Campaign Performance Chart
        function createCampaignPerformanceChart() {
            const ctx = document.getElementById('campaignPerformanceChart');
            if (!ctx) return;

            if (campaignPerformanceChart) {
                campaignPerformanceChart.destroy();
            }

            const data = {
                labels: ['LinkedIn', 'Bloomberg', 'CNBC', 'Reuters'],
                datasets: [{
                    label: 'Performance Score',
                    data: [158, 180, 140, 130],
                    backgroundColor: ['#27ae60', '#0047BA', '#1565C0', '#42A5F5'],
                    borderWidth: 1,
                    borderRadius: 4
                }]
            };

            campaignPerformanceChart = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    layout: {
                        padding: {
                            left: 25,
                            right: 25,
                            top: 25,
                            bottom: 35
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    const fullNames = ['LinkedIn ESG', 'Bloomberg Summit', 'CNBC Clean Energy', 'Reuters Transition'];
                                    return fullNames[context[0].dataIndex];
                                },
                                label: function(context) {
                                    return `Performance Score: ${context.raw}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Performance Index',
                                font: { size: 9 }
                            },
                            ticks: { 
                                font: { size: 8 },
                                padding: 5
                            }
                        },
                        x: {
                            ticks: { 
                                font: { size: 8 },
                                maxRotation: 0,
                                minRotation: 0,
                                padding: 5
                            }
                        }
                    }
                }
            });
        }

        // Create Advanced Media Outlet Radar Chart with Comparative Analysis (Real Q1 2025 Data)
        function createMediaSentimentChart() {
            const ctx = document.getElementById('mediaSentimentChart');
            if (!ctx) return;

            if (mediaSentimentChart) {
                mediaSentimentChart.destroy();
            }

            // Use responsive data based on screen size
            const displayData = getResponsiveOutletData();
            const isMobile = window.innerWidth < 480;

            // Enhanced data processing for radar chart
            const enhancedData = displayData.map(item => {
                // Calculate additional metrics for radar dimensions
                const tierWeight = item.tier === 'Tier 1' ? 100 : item.tier === 'Tier 2' ? 70 : 40;
                const mentionScore = Math.min((item.mentions / 45) * 100, 100); // Normalized to 100 scale
                const themeRelevance = getThemeRelevanceScore(item.theme);
                const competitiveSOV = getCompetitiveSOVScore(item.outlet, item.tier);
                const influenceIndex = (tierWeight + mentionScore) / 2;

                return {
                    ...item,
                    tierWeight,
                    mentionScore,
                    themeRelevance,
                    competitiveSOV,
                    influenceIndex
                };
            });

            // Radar chart labels
            const radarLabels = isMobile 
                ? ['Sentiment', 'Volume', 'Tier', 'Theme', 'SOV']
                : ['Positive Sentiment', 'Mention Volume', 'Tier Influence', 'Theme Relevance', 'Competitive SOV'];

            // Create datasets for each outlet
            const datasets = enhancedData.map((item, index) => {
                const colors = [
                    { bg: 'rgba(0, 71, 186, 0.2)', border: '#0047BA' },      // Bloomberg - Blue
                    { bg: 'rgba(39, 174, 96, 0.2)', border: '#27ae60' },     // WSJ - Green
                    { bg: 'rgba(243, 156, 18, 0.2)', border: '#f39c12' },    // FT - Orange
                    { bg: 'rgba(231, 76, 60, 0.2)', border: '#e74c3c' },     // Reuters - Red
                    { bg: 'rgba(155, 89, 182, 0.2)', border: '#9b59b6' }     // Globe & Mail - Purple
                ];

                const color = colors[index % colors.length];
                const isTier1 = item.tier === 'Tier 1';

                return {
                    label: isMobile ? item.outlet : `${item.outlet} (${item.tier})`,
                    data: [
                        item.positive,
                        item.mentionScore,
                        item.tierWeight,
                        item.themeRelevance,
                        item.competitiveSOV
                    ],
                    backgroundColor: color.bg,
                    borderColor: color.border,
                    borderWidth: isTier1 ? 3 : 2,
                    pointBackgroundColor: color.border,
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: isTier1 ? 3 : 2,
                    pointRadius: isTier1 ? 6 : 4,
                    pointHoverRadius: isTier1 ? 8 : 6,
                    pointHoverBorderWidth: 3,
                    tension: 0.1,
                    fill: true
                };
            });

            const data = {
                labels: radarLabels,
                datasets: datasets
            };

            mediaSentimentChart = new Chart(ctx, {
                type: 'radar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 800,
                        easing: 'easeInOutQuart'
                    },
                    layout: {
                        padding: {
                            top: isMobile ? 15 : 25,
                            bottom: isMobile ? 35 : 45,
                            left: isMobile ? 15 : 25,
                            right: isMobile ? 15 : 25
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: { 
                                    size: isMobile ? 8 : 10,
                                    weight: '600'
                                },
                                padding: isMobile ? 8 : 12,
                                usePointStyle: true,
                                pointStyle: 'circle',
                                boxWidth: isMobile ? 8 : 10,
                                boxHeight: isMobile ? 8 : 10,
                                filter: function(legendItem, chartData) {
                                    // On mobile, show only Tier 1 outlets in legend by default
                                    if (isMobile) {
                                        const outlet = enhancedData[legendItem.datasetIndex];
                                        return outlet.tier === 'Tier 1';
                                    }
                                    return true;
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#0047BA',
                            borderWidth: 2,
                            cornerRadius: 8,
                            displayColors: true,
                            callbacks: {
                                title: function(context) {
                                    const item = enhancedData[context[0].datasetIndex];
                                    return `${item.outlet} (${item.tier})`;
                                },
                                label: function(context) {
                                    const item = enhancedData[context.datasetIndex];
                                    const labels = [
                                        'Positive Sentiment', 'Mention Volume', 'Tier Influence', 
                                        'Theme Relevance', 'Competitive SOV'
                                    ];
                                    const values = [
                                        `${item.positive}%`, 
                                        `${item.mentions} mentions`, 
                                        `${item.tierWeight}% influence`,
                                        `${item.themeRelevance}% relevance`,
                                        `${item.competitiveSOV}% SOV`
                                    ];
                                    return `${labels[context.dataIndex]}: ${values[context.dataIndex]}`;
                                },
                                afterBody: function(context) {
                                    const item = enhancedData[context[0].datasetIndex];
                                    const performance = item.positive >= 75 ? 'Excellent' : 
                                                      item.positive >= 70 ? 'Good' : 'Needs Focus';
                                    return [
                                        '',
                                        `Key Theme: ${item.theme}`,
                                        `Overall Performance: ${performance}`,
                                        `Strategic Priority: ${item.tier === 'Tier 1' ? 'HIGH' : 'MEDIUM'}`,
                                        '',
                                        'Click legend to toggle outlet visibility'
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            min: 0,
                            max: 100,
                            ticks: {
                                stepSize: 20,
                                font: {
                                    size: isMobile ? 8 : 10,
                                    weight: '600'
                                },
                                color: '#666',
                                backdropColor: 'rgba(255, 255, 255, 0.8)',
                                backdropPadding: isMobile ? 2 : 4,
                                showLabelBackdrop: true
                            },
                            grid: {
                                color: 'rgba(0, 71, 186, 0.2)',
                                lineWidth: 1
                            },
                            angleLines: {
                                color: 'rgba(0, 71, 186, 0.3)',
                                lineWidth: 1
                            },
                            pointLabels: {
                                font: {
                                    size: isMobile ? 9 : 11,
                                    weight: '600'
                                },
                                color: '#0047BA',
                                padding: isMobile ? 8 : 12
                            }
                        }
                    },
                    interaction: {
                        mode: 'point',
                        intersect: false
                    },
                    elements: {
                        point: {
                            hoverBorderWidth: 4
                        },
                        line: {
                            borderJoinStyle: 'round'
                        }
                    },
                    onClick: function(event, elements) {
                        if (elements.length > 0) {
                            const datasetIndex = elements[0].datasetIndex;
                            const dataset = this.data.datasets[datasetIndex];
                            dataset.hidden = !dataset.hidden;
                            this.update();
                        }
                    }
                }
            });
        }

        // Helper function to get blue gradient color for risk visualization based on absolute mention counts
        function getBlueGradientColor(mentionCount) {
            if (mentionCount <= 15) return '#E3F2FD'; // Light Blue (Low risk)
            if (mentionCount <= 25) return '#90CAF9'; // Medium Blue (Low-medium risk)
            if (mentionCount <= 35) return '#0047BA'; // ADNOC Blue (Medium risk)
            if (mentionCount <= 45) return '#1565C0'; // Dark Blue (High risk)
            return '#0D47A1'; // Navy Blue (Critical risk)
        }

        // Helper function to get temperature color for backward compatibility
        function getTemperatureColor(percent) {
            if (percent <= 30) return '#E3F2FD'; // Light Blue (Low risk)
            if (percent <= 50) return '#90CAF9'; // Medium Blue (Low-medium risk)
            if (percent <= 70) return '#0047BA'; // ADNOC Blue (Medium risk)
            if (percent <= 85) return '#1565C0'; // Dark Blue (High risk)
            return '#0D47A1'; // Navy Blue (Critical risk)
        }

        // Helper function to calculate theme relevance score
        function getThemeRelevanceScore(theme) {
            const themeScores = {
                'Net Zero leadership': 95,
                'Hydrogen partnership': 90,
                'AI in energy': 85,
                'Policy stability': 75,
                'ESG disclosures': 80
            };
            return themeScores[theme] || 70;
        }

        // Helper function to calculate competitive SOV score
        function getCompetitiveSOVScore(outlet, tier) {
            const sovData = {
                'Bloomberg': 85,
                'WSJ': 80,
                'Financial Times': 75,
                'Reuters': 65,
                'The Globe and Mail': 60
            };
            return sovData[outlet] || (tier === 'Tier 1' ? 75 : 60);
        }

        // Create Stakeholder Engagement Chart
        function createStakeholderEngagementChart() {
            const ctx = document.getElementById('stakeholderEngagementChart');
            if (!ctx) return;

            if (stakeholderEngagementChart) {
                stakeholderEngagementChart.destroy();
            }

            const data = {
                labels: ['New York', 'Chicago', 'Toronto', 'DC'],
                datasets: [{
                    label: 'Meetings',
                    data: [5, 4, 3, 1],
                    backgroundColor: '#0047BA',
                    borderWidth: 1,
                    borderRadius: 4
                }]
            };

            stakeholderEngagementChart = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    layout: {
                        padding: {
                            left: 25,
                            right: 25,
                            top: 25,
                            bottom: 35
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    const fullNames = ['New York', 'Chicago', 'Toronto', 'Washington DC'];
                                    return fullNames[context[0].dataIndex];
                                },
                                label: function(context) {
                                    return `Meetings: ${context.raw}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Meetings',
                                font: { size: 9 }
                            },
                            ticks: { 
                                font: { size: 8 },
                                padding: 5
                            }
                        },
                        x: {
                            ticks: { 
                                font: { size: 8 },
                                maxRotation: 0,
                                minRotation: 0,
                                padding: 5
                            }
                        }
                    }
                }
            });
        }

        // Register custom SOV labels plugin
        const sovLabelsPlugin = {
            id: 'sovLabels',
            afterDatasetsDraw: function(chart) {
                const ctx = chart.ctx;
                const meta = chart.getDatasetMeta(0);
                const isMobile = window.innerWidth < 480;
                
                mediaTierSOVData.forEach((item, index) => {
                    const bar = meta.data[index];
                    const x = bar.x;
                    const y = bar.y - (isMobile ? 25 : 30);
                    
                    // Determine SOV color based on performance
                    let sovColor = '';
                    if (item.sovPercent >= 50) sovColor = '#27ae60'; // Green
                    else if (item.sovPercent >= 45) sovColor = '#f39c12'; // Yellow
                    else sovColor = '#e74c3c'; // Red
                    
                    // Draw SOV percentage label
                    ctx.save();
                    ctx.fillStyle = sovColor;
                    ctx.font = `bold ${isMobile ? 11 : 13}px 'Segoe UI'`;
                    ctx.textAlign = 'center';
                    ctx.fillText(`${item.sovPercent}% SOV`, x, y);
                    
                    // Add small "Share of Voice" indicator if not mobile
                    if (!isMobile) {
                        ctx.fillStyle = '#666';
                        ctx.font = `600 ${isMobile ? 8 : 9}px 'Segoe UI'`;
                        ctx.fillText('Share of Voice', x, y - 15);
                    }
                    
                    ctx.restore();
                });
            }
        };

        // Create Enhanced Media Tier SOV Chart with Share of Voice Labels
        function createMediaTierChart() {
            const ctx = document.getElementById('mediaTierChart');
            if (!ctx) return;

            if (mediaTierChart) {
                mediaTierChart.destroy();
            }

            const isMobile = window.innerWidth < 480;
            const isTablet = window.innerWidth < 768;

            const data = {
                labels: mediaTierSOVData.map(item => isMobile ? item.tier.replace('Tier ', 'T') : item.tier),
                datasets: [{
                    label: isMobile ? 'ADNOC' : 'ADNOC Mentions',
                    data: mediaTierSOVData.map(item => item.adnocMentions),
                    backgroundColor: '#0047BA',
                    borderWidth: 0,
                    borderRadius: isMobile ? 3 : 4,
                    borderColor: '#fff'
                }, {
                    label: isMobile ? 'Peers' : 'Peer Average',
                    data: mediaTierSOVData.map(item => item.peerMentions),
                    backgroundColor: '#95a5a6',
                    borderWidth: 0,
                    borderRadius: isMobile ? 3 : 4,
                    borderColor: '#fff'
                }]
            };

            mediaTierChart = new Chart(ctx, {
                type: 'bar',
                data: data,
                plugins: [sovLabelsPlugin],
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    layout: {
                        padding: {
                            top: isMobile ? 35 : isTablet ? 40 : 45, // Increased for SOV labels
                            bottom: isMobile ? 25 : isTablet ? 30 : 35,
                            left: isMobile ? 10 : isTablet ? 15 : 20,
                            right: isMobile ? 10 : isTablet ? 15 : 20
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { 
                                font: { 
                                    size: isMobile ? 9 : isTablet ? 10 : 11,
                                    weight: '600'
                                },
                                padding: isMobile ? 8 : isTablet ? 10 : 12,
                                usePointStyle: true,
                                pointStyle: 'circle',
                                boxWidth: isMobile ? 8 : 10,
                                boxHeight: isMobile ? 8 : 10
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#0047BA',
                            borderWidth: 2,
                            cornerRadius: 8,
                            displayColors: true,
                            callbacks: {
                                title: function(context) {
                                    const item = mediaTierSOVData[context[0].dataIndex];
                                    return `${item.tier} Media Coverage`;
                                },
                                label: function(context) {
                                    const item = mediaTierSOVData[context.dataIndex];
                                    const isADNOC = context.datasetIndex === 0;
                                    const mentions = isADNOC ? item.adnocMentions : item.peerMentions;
                                    const label = isADNOC ? 'ADNOC' : 'Peer Average';
                                    return `${label}: ${mentions} mentions`;
                                },
                                afterBody: function(context) {
                                    const item = mediaTierSOVData[context[0].dataIndex];
                                    const competitive = item.adnocMentions > item.peerMentions ? 'Leading' : 'Behind';
                                    const difference = Math.abs(item.adnocMentions - item.peerMentions);
                                    const advantage = item.adnocMentions > item.peerMentions ? 
                                        `+${difference} advantage` : `-${difference} behind`;
                                    
                                    // SOV performance assessment with icons
                                    let sovStatus = '';
                                    if (item.sovPercent >= 50) sovStatus = '✓ Competitive Advantage';
                                    else if (item.sovPercent >= 45) sovStatus = '⚠ Competitive Parity';
                                    else sovStatus = '✗ Competitive Disadvantage';
                                    
                                    return [
                                        '',
                                        `Share of Voice: ${item.sovPercent}%`,
                                        `Position: ${competitive} (${advantage})`,
                                        `Status: ${sovStatus}`,
                                        '',
                                        item.tier === 'Tier 1' ? '↗ Premium outlets (highest investor influence)' :
                                        item.tier === 'Tier 2' ? '→ Standard outlets (moderate investor influence)' :
                                        '↘ Specialized outlets (niche investor influence)'
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {
                                display: !isMobile,
                                text: 'Number of Mentions',
                                font: { 
                                    size: isMobile ? 8 : isTablet ? 9 : 10,
                                    weight: 'bold'
                                },
                                color: '#0047BA'
                            },
                            ticks: { 
                                font: { 
                                    size: isMobile ? 8 : isTablet ? 9 : 10,
                                    weight: '600'
                                },
                                color: '#333',
                                padding: isMobile ? 6 : 8,
                                maxRotation: 0,
                                minRotation: 0
                            },
                            grid: {
                                color: 'rgba(0, 71, 186, 0.1)',
                                lineWidth: 1
                            }
                        },
                        y: {
                            ticks: { 
                                font: { 
                                    size: isMobile ? 8 : isTablet ? 9 : 10,
                                    weight: '600'
                                },
                                color: '#333',
                                padding: isMobile ? 6 : 8
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    elements: {
                        bar: {
                            borderSkipped: false
                        }
                    }
                }
            });
        }

        // Create Investor Perception Spider/Radar Chart
        function createInvestorPerceptionChart() {
            const ctx = document.getElementById('investorPerceptionChart');
            if (!ctx) return;

            if (investorPerceptionChart) {
                investorPerceptionChart.destroy();
            }

            const perceptionData = [
                { attribute: 'Credibility on Net Zero', q4: 68, q1: 74 },
                { attribute: 'Innovation in Clean Tech', q4: 64, q1: 70 },
                { attribute: 'Transparency on ESG Metrics', q4: 61, q1: 69 },
                { attribute: 'Reliability as Energy Partner', q4: 74, q1: 78 },
                { attribute: 'Alignment with Global Standards', q4: 66, q1: 72 }
            ];

            const data = {
                labels: perceptionData.map(item => item.attribute),
                datasets: [{
                    label: 'Q4 2024',
                    data: perceptionData.map(item => item.q4),
                    backgroundColor: 'rgba(149, 165, 166, 0.2)',
                    borderColor: '#95a5a6',
                    borderWidth: 2,
                    pointBackgroundColor: '#95a5a6',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                    pointHoverRadius: 7
                }, {
                    label: 'Q1 2025',
                    data: perceptionData.map(item => item.q1),
                    backgroundColor: 'rgba(0, 71, 186, 0.3)',
                    borderColor: '#0047BA',
                    borderWidth: 2,
                    pointBackgroundColor: '#0047BA',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 6,
                    pointHoverRadius: 8
                }]
            };

            investorPerceptionChart = new Chart(ctx, {
                type: 'radar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    layout: {
                        padding: {
                            left: 30,
                            right: 30,
                            top: 30,
                            bottom: 50
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: {
                                    size: 14,
                                    weight: '600'
                                },
                                usePointStyle: true,
                                pointStyle: 'circle',
                                boxWidth: 12,
                                boxHeight: 12
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#0047BA',
                            borderWidth: 1,
                            cornerRadius: 6,
                            displayColors: true,
                            callbacks: {
                                title: function(context) {
                                    return perceptionData[context[0].dataIndex].attribute;
                                },
                                label: function(context) {
                                    const period = context.datasetIndex === 0 ? 'Q4 2024' : 'Q1 2025';
                                    const value = context.raw;
                                    const item = perceptionData[context.dataIndex];
                                    const improvement = item.q1 - item.q4;
                                    const improvementPercent = ((improvement / item.q4) * 100).toFixed(1);
                                    
                                    return [
                                        `${period}: ${value}`,
                                        `Improvement: +${improvement} points (+${improvementPercent}%)`
                                    ];
                                },
                                afterBody: function(context) {
                                    const item = perceptionData[context[0].dataIndex];
                                    return [
                                        '',
                                        'Performance Trajectory: ↗️ Positive Growth',
                                        `Score Range: ${item.q4} → ${item.q1}`,
                                        '',
                                        'All attributes show consistent improvement',
                                        'demonstrating strengthened investor confidence'
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: false,
                            min: 55,
                            max: 85,
                            ticks: {
                                stepSize: 5,
                                font: {
                                    size: 12,
                                    weight: '600'
                                },
                                color: '#666',
                                backdropColor: 'rgba(255, 255, 255, 0.8)',
                                backdropPadding: 4
                            },
                            grid: {
                                color: 'rgba(0, 71, 186, 0.2)',
                                lineWidth: 1
                            },
                            angleLines: {
                                color: 'rgba(0, 71, 186, 0.3)',
                                lineWidth: 1
                            },
                            pointLabels: {
                                font: {
                                    size: 12,
                                    weight: '600'
                                },
                                color: '#0047BA',
                                padding: 15
                            }
                        }
                    },
                    interaction: {
                        mode: 'point',
                        intersect: false
                    },
                    elements: {
                        point: {
                            hoverBorderWidth: 4
                        },
                        line: {
                            borderJoinStyle: 'round'
                        }
                    }
                }
            });
        }

        // Create KPI Trend Chart with Dual Y-Axes
        function createKpiTrendChart() {
            const ctx = document.getElementById('kpiTrendChart');
            if (!ctx) return;

            if (kpiTrendChart) {
                kpiTrendChart.destroy();
            }

            const data = {
                labels: ['Q2 \'24', 'Q3 \'24', 'Q4 \'24', 'Q1 \'25'],
                datasets: [{
                    label: 'ESG Trust Score',
                    data: [68, 70, 72, 78],
                    borderColor: '#0047BA',
                    backgroundColor: 'rgba(0, 71, 186, 0.15)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4,
                    yAxisID: 'y',
                    pointBackgroundColor: '#0047BA',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                    pointHoverRadius: 7
                }, {
                    label: 'Positive ESG Media SOV (%)',
                    data: [15, 17, 19, 26],
                    borderColor: '#27ae60',
                    backgroundColor: 'rgba(39, 174, 96, 0.15)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4,
                    yAxisID: 'y1',
                    pointBackgroundColor: '#27ae60',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                    pointHoverRadius: 7
                }, {
                    label: 'Net Zero Brand Uplift (%)',
                    data: [2.3, 3.5, 4.1, 6.8],
                    borderColor: '#f39c12',
                    backgroundColor: 'rgba(243, 156, 18, 0.15)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4,
                    yAxisID: 'y1',
                    pointBackgroundColor: '#f39c12',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                    pointHoverRadius: 7
                }, {
                    label: 'Campaign ROI (US/Canada)',
                    data: [1.7, 1.9, 2.1, 2.6],
                    borderColor: '#e74c3c',
                    backgroundColor: 'rgba(231, 76, 60, 0.15)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4,
                    yAxisID: 'y1',
                    pointBackgroundColor: '#e74c3c',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 5,
                    pointHoverRadius: 7
                }]
            };

            kpiTrendChart = new Chart(ctx, {
                type: 'line',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    layout: {
                        padding: {
                            left: 25,
                            right: 25,
                            top: 25,
                            bottom: 40
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 25,
                                font: {
                                    size: 13,
                                    weight: '600'
                                },
                                usePointStyle: true,
                                pointStyle: 'circle',
                                boxWidth: 12,
                                boxHeight: 12
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#0047BA',
                            borderWidth: 1,
                            cornerRadius: 6,
                            displayColors: true,
                            callbacks: {
                                title: function(context) {
                                    return context[0].label;
                                },
                                label: function(context) {
                                    const label = context.dataset.label;
                                    const value = context.raw;
                                    if (label.includes('SOV') || label.includes('Uplift')) {
                                        return `${label}: ${value}%`;
                                    } else if (label.includes('ROI')) {
                                        return `${label}: ${value}x`;
                                    } else {
                                        return `${label}: ${value}`;
                                    }
                                },
                                afterBody: function(context) {
                                    if (context[0].label === 'Q1 \'25') {
                                        return [
                                            '',
                                            'Q1 2025 Growth vs Q2 2024:',
                                            '• ESG Trust: +14.7%',
                                            '• Media SOV: +73.3%',
                                            '• Brand Uplift: +195.7%',
                                            '• Campaign ROI: +52.9%'
                                        ];
                                    }
                                    return null;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Quarter',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: '#0047BA'
                            },
                            ticks: {
                                font: {
                                    size: 12,
                                    weight: '600'
                                },
                                color: '#333'
                            },
                            grid: {
                                color: 'rgba(0, 71, 186, 0.1)',
                                lineWidth: 1
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            min: 65,
                            max: 80,
                            title: {
                                display: true,
                                text: 'ESG Trust Score',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: '#0047BA'
                            },
                            ticks: {
                                font: {
                                    size: 12,
                                    weight: '600'
                                },
                                color: '#0047BA',
                                stepSize: 2
                            },
                            grid: {
                                color: 'rgba(0, 71, 186, 0.1)',
                                lineWidth: 1
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            min: 0,
                            max: 30,
                            title: {
                                display: true,
                                text: 'Percentages & ROI Multiplier',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: '#27ae60'
                            },
                            ticks: {
                                font: {
                                    size: 12,
                                    weight: '600'
                                },
                                color: '#27ae60',
                                stepSize: 5
                            },
                            grid: {
                                drawOnChartArea: false,
                                color: 'rgba(39, 174, 96, 0.1)',
                                lineWidth: 1
                            }
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    elements: {
                        line: {
                            borderJoinStyle: 'round'
                        },
                        point: {
                            hoverBorderWidth: 3
                        }
                    }
                }
            });
        }

        // Campaign Dashboard Data and Functionality
        let campaignData = [];
        let campaignDashboardChart = null;
        let activeMetrics = ['impressions'];

        // Media Dashboard Data and Functionality
        let mediaDashboardChart = null;
        let activeMediaMetrics = ['sov'];

        // Load campaign data
        async function loadCampaignData() {
            // Simulated data from CSV - in production this would fetch from the actual CSV file
            campaignData = [
                {
                    campaign: 'LinkedIn Thought Leadership',
                    impressions: 3.2,
                    ctr: 1.6,
                    brandUplift: 1.5,
                    engagement: 4.2,
                    costPerClick: 2.85,
                    sentiment: 78,
                    leads: 245
                },
                {
                    campaign: 'Bloomberg ESG Summit',
                    impressions: 5.2,
                    ctr: 2.3,
                    brandUplift: 1.8,
                    engagement: 5.8,
                    costPerClick: 3.20,
                    sentiment: 82,
                    leads: 387
                },
                {
                    campaign: 'CNBC Clean Energy Week',
                    impressions: 2.8,
                    ctr: 2.0,
                    brandUplift: 1.4,
                    engagement: 3.9,
                    costPerClick: 2.95,
                    sentiment: 75,
                    leads: 198
                },
                {
                    campaign: 'Reuters Energy Transition Series',
                    impressions: 1.9,
                    ctr: 1.4,
                    brandUplift: 1.3,
                    engagement: 3.1,
                    costPerClick: 3.45,
                    sentiment: 71,
                    leads: 142
                },
                {
                    campaign: 'Financial Times Sustainability',
                    impressions: 4.1,
                    ctr: 2.1,
                    brandUplift: 1.6,
                    engagement: 4.7,
                    costPerClick: 3.10,
                    sentiment: 79,
                    leads: 298
                },
                {
                    campaign: 'Wall Street Journal ESG Focus',
                    impressions: 3.8,
                    ctr: 1.9,
                    brandUplift: 1.7,
                    engagement: 4.3,
                    costPerClick: 3.25,
                    sentiment: 81,
                    leads: 267
                },
                {
                    campaign: 'Twitter Energy Innovation',
                    impressions: 2.3,
                    ctr: 1.2,
                    brandUplift: 1.2,
                    engagement: 2.8,
                    costPerClick: 2.15,
                    sentiment: 73,
                    leads: 156
                },
                {
                    campaign: 'YouTube Clean Tech Series',
                    impressions: 1.7,
                    ctr: 3.2,
                    brandUplift: 1.4,
                    engagement: 6.1,
                    costPerClick: 1.95,
                    sentiment: 76,
                    leads: 189
                },
                {
                    campaign: 'Forbes Sustainability Leaders',
                    impressions: 2.9,
                    ctr: 1.8,
                    brandUplift: 1.5,
                    engagement: 3.6,
                    costPerClick: 3.05,
                    sentiment: 77,
                    leads: 203
                },
                {
                    campaign: 'Harvard Business Review ESG',
                    impressions: 1.4,
                    ctr: 2.4,
                    brandUplift: 1.9,
                    engagement: 5.2,
                    costPerClick: 4.15,
                    sentiment: 84,
                    leads: 167
                }
            ];

            updateSummaryCards();
            populateTable();
            createCampaignDashboardChart();
        }

        // Update summary cards with top performers
        function updateSummaryCards() {
            const topImpressions = campaignData.reduce((prev, current) => (prev.impressions > current.impressions) ? prev : current);
            const topCTR = campaignData.reduce((prev, current) => (prev.ctr > current.ctr) ? prev : current);
            const topBrandUplift = campaignData.reduce((prev, current) => (prev.brandUplift > current.brandUplift) ? prev : current);
            const topEngagement = campaignData.reduce((prev, current) => (prev.engagement > current.engagement) ? prev : current);

            document.getElementById('topImpressions').textContent = `${topImpressions.impressions}M`;
            document.getElementById('topImpressionsCampaign').textContent = topImpressions.campaign;
            
            document.getElementById('topCTR').textContent = `${topCTR.ctr}%`;
            document.getElementById('topCTRCampaign').textContent = topCTR.campaign;
            
            document.getElementById('topBrandUplift').textContent = `${topBrandUplift.brandUplift}x`;
            document.getElementById('topBrandUpliftCampaign').textContent = topBrandUplift.campaign;
            
            document.getElementById('topEngagement').textContent = `${topEngagement.engagement}%`;
            document.getElementById('topEngagementCampaign').textContent = topEngagement.campaign;
        }

        // Create interactive campaign dashboard chart
        function createCampaignDashboardChart() {
            const ctx = document.getElementById('campaignDashboardChart');
            if (!ctx) return;

            if (campaignDashboardChart) {
                campaignDashboardChart.destroy();
            }

            const labels = campaignData.map(item => item.campaign.split(' ').slice(0, 2).join(' '));
            const datasets = [];

            const metricConfig = {
                impressions: { label: 'Impressions (M)', color: '#0047BA', data: campaignData.map(item => item.impressions) },
                ctr: { label: 'CTR (%)', color: '#27ae60', data: campaignData.map(item => item.ctr) },
                brandUplift: { label: 'Brand Uplift (x)', color: '#f39c12', data: campaignData.map(item => item.brandUplift) },
                engagement: { label: 'Engagement (%)', color: '#e74c3c', data: campaignData.map(item => item.engagement) },
                costPerClick: { label: 'Cost Per Click ($)', color: '#9b59b6', data: campaignData.map(item => item.costPerClick) },
                sentiment: { label: 'Sentiment Score', color: '#1abc9c', data: campaignData.map(item => item.sentiment) },
                leads: { label: 'Lead Generation', color: '#34495e', data: campaignData.map(item => item.leads) }
            };

            activeMetrics.forEach(metric => {
                if (metricConfig[metric]) {
                    datasets.push({
                        label: metricConfig[metric].label,
                        data: metricConfig[metric].data,
                        backgroundColor: metricConfig[metric].color,
                        borderColor: metricConfig[metric].color,
                        borderWidth: 1
                    });
                }
            });

            campaignDashboardChart = new Chart(ctx, {
                type: 'bar',
                data: { labels, datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: { font: { size: 11 } }
                        },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return campaignData[context[0].dataIndex].campaign;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: { 
                                font: { size: 10 },
                                maxRotation: 45,
                                minRotation: 0
                            }
                        },
                        y: {
                            beginAtZero: true,
                            ticks: { font: { size: 10 } }
                        }
                    }
                }
            });
        }

        // Get performance class based on value and metric type
        function getPerformanceClass(value, metric) {
            const thresholds = {
                impressions: { excellent: 4.5, good: 3.5, average: 2.5, below: 1.5 },
                ctr: { excellent: 2.8, good: 2.2, average: 1.8, below: 1.4 },
                brandUplift: { excellent: 1.7, good: 1.5, average: 1.3, below: 1.2 },
                engagement: { excellent: 5.5, good: 4.5, average: 3.5, below: 2.5 },
                costPerClick: { excellent: 2.5, good: 3.0, average: 3.5, below: 4.0 }, // Lower is better
                sentiment: { excellent: 80, good: 75, average: 70, below: 65 },
                leads: { excellent: 300, good: 200, average: 150, below: 100 }
            };

            const t = thresholds[metric];
            if (!t) return '';

            // For cost per click, lower values are better
            if (metric === 'costPerClick') {
                if (value <= t.excellent) return 'performance-excellent';
                if (value <= t.good) return 'performance-good';
                if (value <= t.average) return 'performance-average';
                if (value <= t.below) return 'performance-below';
                return 'performance-poor';
            }

            // For all other metrics, higher values are better
            if (value >= t.excellent) return 'performance-excellent';
            if (value >= t.good) return 'performance-good';
            if (value >= t.average) return 'performance-average';
            if (value >= t.below) return 'performance-below';
            return 'performance-poor';
        }

        // Populate data table with heatmap styling
        function populateTable() {
            const tbody = document.getElementById('campaignTableBody');
            if (!tbody) return;

            tbody.innerHTML = '';
            
            campaignData.forEach(item => {
                const row = document.createElement('tr');
                
                const impressionsClass = getPerformanceClass(item.impressions, 'impressions');
                const ctrClass = getPerformanceClass(item.ctr, 'ctr');
                const brandUpliftClass = getPerformanceClass(item.brandUplift, 'brandUplift');
                const engagementClass = getPerformanceClass(item.engagement, 'engagement');
                const costPerClickClass = getPerformanceClass(item.costPerClick, 'costPerClick');
                const sentimentClass = getPerformanceClass(item.sentiment, 'sentiment');
                const leadsClass = getPerformanceClass(item.leads, 'leads');

                row.innerHTML = `
                    <td style="text-align: left; font-weight: 600;">${item.campaign}</td>
                    <td class="heatmap-cell ${impressionsClass}">${item.impressions}</td>
                    <td class="heatmap-cell ${ctrClass}">${item.ctr}</td>
                    <td class="heatmap-cell ${brandUpliftClass}">${item.brandUplift}</td>
                    <td class="heatmap-cell ${engagementClass}">${item.engagement}</td>
                    <td class="heatmap-cell ${costPerClickClass}">$${item.costPerClick}</td>
                    <td class="heatmap-cell ${sentimentClass}">${item.sentiment}</td>
                    <td class="heatmap-cell ${leadsClass}">${item.leads}</td>
                `;
                tbody.appendChild(row);
            });

            // Add heatmap legend if it doesn't exist
            addHeatmapLegend();
        }

        // Add heatmap legend
        function addHeatmapLegend() {
            const tableContainer = document.querySelector('.campaign-data-table');
            if (!tableContainer || document.querySelector('.heatmap-legend')) return;

            const legend = document.createElement('div');
            legend.className = 'heatmap-legend';
            legend.innerHTML = `
                <div class="legend-item">
                    <div class="legend-color legend-excellent"></div>
                    <span>Excellent</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color legend-good"></div>
                    <span>Good</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color legend-average"></div>
                    <span>Average</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color legend-below"></div>
                    <span>Below Average</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color legend-poor"></div>
                    <span>Poor</span>
                </div>
            `;
            tableContainer.appendChild(legend);
        }

        // Handle metric toggle clicks
        function setupMetricToggles() {
            const toggles = document.querySelectorAll('.metric-toggle');
            toggles.forEach(toggle => {
                toggle.addEventListener('click', function() {
                    const metric = this.dataset.metric;
                    
                    if (this.classList.contains('active')) {
                        // Don't allow deselecting if it's the only active metric
                        if (activeMetrics.length > 1) {
                            this.classList.remove('active');
                            activeMetrics = activeMetrics.filter(m => m !== metric);
                        }
                    } else {
                        this.classList.add('active');
                        activeMetrics.push(metric);
                    }
                    
                    createCampaignDashboardChart();
                });
            });
        }

        // Create Media Dashboard Chart
        function createMediaDashboardChart() {
            const ctx = document.getElementById('mediaDashboardChart');
            if (!ctx) return;

            if (mediaDashboardChart) {
                mediaDashboardChart.destroy();
            }

            const labels = mediaOutletData.map(item => item.outlet);
            const datasets = [];

            const mediaMetricConfig = {
                sov: { 
                    label: 'SOV %', 
                    color: '#0047BA', 
                    data: mediaOutletData.map(item => getCompetitiveSOVScore(item.outlet, item.tier))
                },
                sentiment: { 
                    label: 'Sentiment Score', 
                    color: '#27ae60', 
                    data: mediaOutletData.map(item => item.positive) 
                },
                mentions: { 
                    label: 'Mention Volume', 
                    color: '#f39c12', 
                    data: mediaOutletData.map(item => item.mentions) 
                },
                tier: { 
                    label: 'Tier Performance', 
                    color: '#e74c3c', 
                    data: mediaOutletData.map(item => item.tier === 'Tier 1' ? 100 : 70) 
                },
                theme: { 
                    label: 'Theme Relevance', 
                    color: '#9b59b6', 
                    data: mediaOutletData.map(item => getThemeRelevanceScore(item.theme)) 
                }
            };

            activeMediaMetrics.forEach(metric => {
                if (mediaMetricConfig[metric]) {
                    datasets.push({
                        label: mediaMetricConfig[metric].label,
                        data: mediaMetricConfig[metric].data,
                        backgroundColor: mediaMetricConfig[metric].color,
                        borderColor: mediaMetricConfig[metric].color,
                        borderWidth: 1
                    });
                }
            });

            mediaDashboardChart = new Chart(ctx, {
                type: 'bar',
                data: { labels, datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: { font: { size: 11 } }
                        },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    const item = mediaOutletData[context[0].dataIndex];
                                    return `${item.outlet} (${item.tier})`;
                                },
                                afterBody: function(context) {
                                    const item = mediaOutletData[context[0].dataIndex];
                                    return [
                                        '',
                                        `Theme: ${item.theme}`,
                                        `Mentions: ${item.mentions}`,
                                        `Positive Sentiment: ${item.positive}%`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: { 
                                font: { size: 10 },
                                maxRotation: 45,
                                minRotation: 0
                            }
                        },
                        y: {
                            beginAtZero: true,
                            ticks: { font: { size: 10 } }
                        }
                    }
                }
            });
        }

        // Handle media metric toggle clicks
        function setupMediaMetricToggles() {
            const toggles = document.querySelectorAll('.metric-toggle[data-metric]');
            toggles.forEach(toggle => {
                // Skip if this is a campaign toggle (has parent with campaign dashboard)
                if (toggle.closest('.campaign-dashboard-container') && 
                    !toggle.closest('.campaign-dashboard-container').querySelector('#mediaDashboardChart')) {
                    return;
                }
                
                // Only handle media dashboard toggles
                if (toggle.closest('.campaign-dashboard-container') && 
                    toggle.closest('.campaign-dashboard-container').querySelector('#mediaDashboardChart')) {
                    
                    toggle.addEventListener('click', function() {
                        const metric = this.dataset.metric;
                        
                        // Remove active from all media toggles
                        const mediaToggles = this.closest('.metric-toggles').querySelectorAll('.metric-toggle');
                        mediaToggles.forEach(t => t.classList.remove('active'));
                        
                        // Add active to clicked toggle
                        this.classList.add('active');
                        activeMediaMetrics = [metric];
                        
                        createMediaDashboardChart();
                    });
                }
            });
        }

        // Populate Media Outlet Table with Real CSV Data
        function populateMediaOutletTable() {
            const tbody = document.getElementById('mediaOutletTableBody');
            if (!tbody) return;

            tbody.innerHTML = '';
            
            mediaOutletData.forEach(item => {
                const row = document.createElement('tr');
                
                // Determine performance status
                let status, statusClass;
                if (item.positive >= 75) {
                    status = 'Excellent';
                    statusClass = 'status-excellent';
                } else if (item.positive >= 70) {
                    status = 'Good';
                    statusClass = 'status-good';
                } else {
                    status = 'Focus';
                    statusClass = 'status-focus';
                }

                // Determine sentiment class
                let sentimentClass;
                if (item.positive >= 75) {
                    sentimentClass = 'sentiment-excellent';
                } else if (item.positive >= 70) {
                    sentimentClass = 'sentiment-good';
                } else {
                    sentimentClass = 'sentiment-focus';
                }

                // Tier badge class
                const tierClass = item.tier === 'Tier 1' ? 'tier-1' : 'tier-2';
                const tierBadge = item.tier === 'Tier 1' ? 'T1' : 'T2';

                row.innerHTML = `
                    <td style="text-align: left; font-weight: 600;">${item.outlet}</td>
                    <td><span class="tier-badge ${tierClass}">${tierBadge}</span></td>
                    <td>${item.mentions}</td>
                    <td class="${sentimentClass}">${item.positive}%</td>
                    <td><span class="theme-tag">${item.theme}</span></td>
                    <td><span class="status-indicator ${statusClass}">${status}</span></td>
                `;
                tbody.appendChild(row);
            });

            // Add sorting functionality
            setupTableSorting();
        }

        // Setup table sorting functionality
        function setupTableSorting() {
            const headers = document.querySelectorAll('#mediaOutletTable .sortable');
            headers.forEach(header => {
                header.addEventListener('click', function() {
                    const sortBy = this.dataset.sort;
                    sortMediaOutletTable(sortBy);
                });
            });
        }

        // Sort media outlet table
        function sortMediaOutletTable(sortBy) {
            let sortedData = [...mediaOutletData];
            
            sortedData.sort((a, b) => {
                let aVal, bVal;
                
                switch(sortBy) {
                    case 'outlet':
                        return a.outlet.localeCompare(b.outlet);
                    case 'tier':
                        aVal = a.tier === 'Tier 1' ? 1 : 2;
                        bVal = b.tier === 'Tier 1' ? 1 : 2;
                        return aVal - bVal;
                    case 'mentions':
                        return b.mentions - a.mentions; // Descending
                    case 'positive':
                        return b.positive - a.positive; // Descending
                    case 'theme':
                        return a.theme.localeCompare(b.theme);
                    case 'status':
                        aVal = a.positive >= 75 ? 3 : a.positive >= 70 ? 2 : 1;
                        bVal = b.positive >= 75 ? 3 : b.positive >= 70 ? 2 : 1;
                        return bVal - aVal; // Descending (best first)
                    default:
                        return 0;
                }
            });

            // Update the global data and repopulate table
            const originalData = [...mediaOutletData];
            mediaOutletData.length = 0;
            mediaOutletData.push(...sortedData);
            populateMediaOutletTable();
            // Restore original order for other functions
            setTimeout(() => {
                mediaOutletData.length = 0;
                mediaOutletData.push(...originalData);
            }, 100);
        }

        // Create Stylish Progress Bar Trust Damagers Chart - Hot to Cold Temperature Design
        function createTrustDamagersChart() {
            const ctx = document.getElementById('trustDamagersChart');
            if (!ctx) return;

            // Clear any existing chart
            ctx.innerHTML = '';

            // Forward Risk Indicators Data
            const riskData = [
                { theme: 'Carbon Capture Implementation Delays', q4: 18, q1: 31, risk: 'HIGH', priority: 1 },
                { theme: 'Regional Political Uncertainty', q4: 22, q1: 28, risk: 'HIGH', priority: 2 },
                { theme: 'ESG Audit Transparency Gaps', q4: 9, q1: 18, risk: 'MEDIUM', priority: 3 },
                { theme: 'Greenwashing Allegations', q4: 12, q1: 27, risk: 'MEDIUM', priority: 4 },
                { theme: 'Clean Tech Visibility Gaps', q4: 14, q1: 26, risk: 'MEDIUM', priority: 5 }
            ];

            // Sort by Q1 values for visual hierarchy
            const sortedData = riskData.sort((a, b) => b.q1 - a.q1);
            const maxValue = Math.max(...sortedData.map(item => item.q1));
            const isMobile = window.innerWidth < 480;
            const isTablet = window.innerWidth < 768;

            // Create custom HTML progress bar visualization
            const container = ctx.parentElement;
            container.innerHTML = `
                <div class="chart-title">Forward Risk Indicators | Q4 2024 → Q1 2025 Escalation</div>
                <div class="progress-bars-container" style="
                    padding: ${isMobile ? '25px 20px' : '40px 35px'};
                    background: #ffffff;
                    border-radius: 8px;
                    box-shadow: 0 2px 8px rgba(0, 71, 186, 0.1);
                    margin: 25px 0;
                    height: ${isMobile ? '450px' : '700px'};
                ">
                    ${sortedData.map((item, index) => {
                        const q4Percent = (item.q4 / maxValue) * 100;
                        const q1Percent = (item.q1 / maxValue) * 100;
                        const escalation = ((item.q1 - item.q4) / item.q4 * 100).toFixed(1);
                        
                        // Responsive label handling
                        let displayLabel = item.theme;
                        if (isMobile) {
                            const mobileLabels = {
                                'Carbon Capture Implementation': 'Carbon Capture',
                                'Regional Stability Concerns': 'Regional Stability',
                                'ESG Transparency Gaps': 'ESG Transparency',
                                'Sustainability Claims Scrutiny': 'Sustainability Claims',
                                'Technology Leadership Visibility': 'Tech Leadership'
                            };
                            displayLabel = mobileLabels[item.theme] || item.theme;
                        } else if (isTablet && item.theme.length > 25) {
                            displayLabel = item.theme.substring(0, 22) + '...';
                        }

                        // Professional corporate colors - Blues & Grays
                        const getCorporateColor = (percent) => {
                            if (percent <= 20) return '#E8F4FD'; // Light Blue
                            if (percent <= 40) return '#B3D9F2'; // Medium Blue
                            if (percent <= 60) return '#7FB8E5'; // Blue
                            if (percent <= 80) return '#4A90C2'; // Dark Blue
                            return '#2C5F8B'; // Navy Blue
                        };

                        // Apply updated temperature color scale
                        const q4Color = getTemperatureColor(q4Percent);
                        const q1Color = getTemperatureColor(q1Percent);

                        return `
                            <div class="progress-bar-item" style="
                                margin-bottom: ${isMobile ? '15px' : '20px'};
                                position: relative;
                            ">
                                <div class="progress-label" style="
                                    font-size: ${isMobile ? '12px' : '14px'};
                                    font-weight: 600;
                                    color: #2c3e50;
                                    margin-bottom: 8px;
                                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                                ">${displayLabel}</div>
                                
                                <div class="progress-bar-track" style="
                                    position: relative;
                                    height: ${isMobile ? '16px' : '18px'};
                                    background: linear-gradient(to right, 
                                        #E8F4FD 0%, 
                                        #B3D9F2 25%, 
                                        #7FB8E5 50%, 
                                        #4A90C2 75%, 
                                        #2C5F8B 100%);
                                    border-radius: 8px;
                                    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
                                    overflow: visible;
                                    margin: 0 ${isMobile ? '10px' : '12px'};
                                    border: 1px solid rgba(0, 71, 186, 0.1);
                                ">
                                    
                                    <!-- Q4 2024 Baseline Marker -->
                                    <div class="q4-marker" style="
                                        position: absolute;
                                        left: calc(${Math.max(5, Math.min(95, q4Percent))}% - ${isMobile ? '12px' : '15px'});
                                        top: 50%;
                                        transform: translateY(-50%);
                                        width: ${isMobile ? '12px' : '14px'};
                                        height: ${isMobile ? '12px' : '14px'};
                                        background: ${q4Color};
                                        border: 3px solid #ffffff;
                                        border-radius: 50%;
                                        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
                                        z-index: 2;
                                        cursor: pointer;
                                    " title="Q4 2024: ${item.q4} mentions"></div>
                                    
                                    <!-- Q1 2025 Current Risk Marker -->
                                    <div class="q1-marker" style="
                                        position: absolute;
                                        left: calc(${Math.max(5, Math.min(95, q1Percent))}% - ${isMobile ? '15px' : '15px'});
                                        top: 50%;
                                        transform: translateY(-50%);
                                        width: ${isMobile ? '16px' : '20px'};
                                        height: ${isMobile ? '16px' : '20px'};
                                        background: ${q1Color};
                                        border: 4px solid #ffffff;
                                        border-radius: 50%;
                                        box-shadow: 0 3px 8px rgba(0,0,0,0.4);
                                        z-index: 3;
                                        cursor: pointer;
                                        animation: pulse 2s infinite;
                                    " title="Q1 2025: ${item.q1} mentions (+${escalation}%)"></div>
                                    
                                    <!-- Connecting line -->
                                    <div style="
                                        position: absolute;
                                        left: calc(${Math.max(5, Math.min(95, Math.min(q4Percent, q1Percent)))}%);
                                        top: 50%;
                                        width: calc(${Math.max(5, Math.min(95, Math.max(q4Percent, q1Percent)))}% - ${Math.max(5, Math.min(95, Math.min(q4Percent, q1Percent)))}%);
                                        height: 2px;
                                        background: rgba(0, 71, 186, 0.4);
                                        transform: translateY(-50%);
                                        z-index: 1;
                                    "></div>
                                </div>
                                
                                <!-- Risk metrics -->
                                <div class="risk-metrics" style="
                                    display: flex;
                                    justify-content: space-between;
                                    align-items: center;
                                    margin-top: 8px;
                                    font-size: ${isMobile ? '10px' : '11px'};
                                    color: #666;
                                ">
                                    <div style="display: flex; gap: 15px;">
                                        <span style="color: ${q4Color}; font-weight: 600;">Q4: ${item.q4}</span>
                                        <span style="color: ${q1Color}; font-weight: 600;">Q1: ${item.q1}</span>
                                        <span style="color: ${escalation > 50 ? '#e74c3c' : escalation > 25 ? '#f39c12' : '#27ae60'}; font-weight: 600;">+${escalation}%</span>
                                    </div>
                                    <div style="
                                        padding: 2px 8px;
                                        border-radius: 12px;
                                        font-size: ${isMobile ? '9px' : '10px'};
                                        font-weight: 600;
                                        text-transform: uppercase;
                                        letter-spacing: 0.3px;
                                        background: ${item.risk === 'HIGH' ? 'rgba(231, 76, 60, 0.1)' : 'rgba(243, 156, 18, 0.1)'};
                                        color: ${item.risk === 'HIGH' ? '#e74c3c' : '#f39c12'};
                                        border: 1px solid ${item.risk === 'HIGH' ? 'rgba(231, 76, 60, 0.3)' : 'rgba(243, 156, 18, 0.3)'};
                                    ">${item.risk} PRIORITY</div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                    
                    <!-- Blue Gradient Risk Legend -->
                    <div class="temperature-legend" style="
                        margin-top: 30px;
                        padding: 20px;
                        background: #f8f9fa;
                        border-radius: 8px;
                        border: 1px solid #e1e5e9;
                    ">
                        <div style="
                            font-size: ${isMobile ? '12px' : '14px'};
                            font-weight: 600;
                            color: #0047BA;
                            margin-bottom: 15px;
                            text-transform: uppercase;
                            letter-spacing: 0.5px;
                        ">Risk Intensity Scale</div>
                        
                        <div style="
                            display: flex;
                            align-items: center;
                            gap: 15px;
                            margin-bottom: 10px;
                        ">
                            <div style="
                                height: 12px;
                                flex: 1;
                                background: linear-gradient(to right, 
                                    #E3F2FD 0%, 
                                    #90CAF9 25%, 
                                    #0047BA 50%, 
                                    #1565C0 75%, 
                                    #0D47A1 100%);
                                border-radius: 6px;
                                box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
                            "></div>
                        </div>
                        
                        <div style="
                            display: flex;
                            justify-content: space-between;
                            font-size: ${isMobile ? '10px' : '11px'};
                            color: #666;
                            font-weight: 600;
                            align-items: center;
                        ">
                            <span style="color: #E3F2FD; display: flex; align-items: center; gap: 4px; text-shadow: 1px 1px 2px rgba(0,0,0,0.5);">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="#90CAF9">
                                    <path d="M12 2L2 7V10C2 16 6 20.9 12 22C18 20.9 22 16 22 10V7L12 2Z"/>
                                </svg>
                                LOW (0-15)
                            </span>
                            <span style="color: #90CAF9; display: flex; align-items: center; gap: 4px;">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"/>
                                </svg>
                                WATCH (16-25)
                            </span>
                            <span style="color: #0047BA; display: flex; align-items: center; gap: 4px;">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"/>
                                </svg>
                                ATTENTION (26-35)
                            </span>
                            <span style="color: #1565C0; display: flex; align-items: center; gap: 4px;">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M13,14H11V10H13M13,18H11V16H13M1,21H23L12,2L1,21Z"/>
                                </svg>
                                CONCERN (36-45)
                            </span>
                            <span style="color: #0D47A1; display: flex; align-items: center; gap: 4px;">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12,1L21,5V11C21,16.55 17.16,21.74 12,23C6.84,21.74 3,16.55 3,11V5L12,1M12,7C10.9,7 10,7.9 10,9V15C10,16.1 10.9,17 12,17C13.1,17 14,16.1 14,15V9C14,7.9 13.1,7 12,7Z"/>
                                </svg>
                                CRITICAL (45+)
                            </span>
                        </div>
                    </div>
                </div>
                
                <style>
                    @keyframes pulse {
                        0% { transform: translate(-50%, -50%) scale(1); }
                        50% { transform: translate(-50%, -50%) scale(1.1); }
                        100% { transform: translate(-50%, -50%) scale(1); }
                    }
                    
                    .progress-bar-item:hover .progress-bar-track {
                        transform: scale(1.02);
                        transition: transform 0.2s ease;
                    }
                    
                    .q4-marker:hover, .q1-marker:hover {
                        transform: translate(-50%, -50%) scale(1.2);
                        transition: transform 0.2s ease;
                    }
                    
                    @media (max-width: 479px) {
                        .progress-bars-container {
                            padding: 15px 10px !important;
                        }
                        .risk-metrics {
                            flex-direction: column !important;
                            align-items: flex-start !important;
                            gap: 8px !important;
                        }
                    }
                </style>
            `;

            // Add interactive tooltips
            const markers = container.querySelectorAll('.q4-marker, .q1-marker');
            markers.forEach((marker, index) => {
                const itemIndex = Math.floor(index / 2);
                const isQ1 = index % 2 === 1;
                const item = sortedData[itemIndex];
                
                marker.addEventListener('mouseenter', function(e) {
                    const tooltip = document.createElement('div');
                    const escalation = ((item.q1 - item.q4) / item.q4 * 100).toFixed(1);
                    
                    let riskIcon = '';
                    let riskLevel = '';
                    if (escalation > 70) {
                        riskIcon = '🔴';
                        riskLevel = 'Critical Escalation';
                    } else if (escalation > 40) {
                        riskIcon = '🟠';
                        riskLevel = 'Significant Escalation';
                    } else if (escalation > 20) {
                        riskIcon = '🟡';
                        riskLevel = 'Moderate Escalation';
                    } else {
                        riskIcon = '🟢';
                        riskLevel = 'Manageable Growth';
                    }
                    
                    const actionRequired = item.risk === 'HIGH' ? 
                        '⚡ Executive Action Required' : '📋 Strategic Monitoring';
                    
                    tooltip.innerHTML = `
                        <div style="
                            position: absolute;
                            background: rgba(44, 62, 80, 0.96);
                            color: white;
                            padding: 12px 16px;
                            border-radius: 8px;
                            font-size: 12px;
                            font-weight: 500;
                            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                            z-index: 1000;
                            min-width: 200px;
                            border: 2px solid #0047BA;
                        ">
                            <div style="font-weight: 700; margin-bottom: 8px; color: #ffffff;">
                                ${item.theme}
                            </div>
                            <div style="margin-bottom: 4px;">
                                ${isQ1 ? 'Q1 2025' : 'Q4 2024'}: ${isQ1 ? item.q1 : item.q4} mentions
                            </div>
                            ${isQ1 ? `
                                <div style="margin-bottom: 4px;">Quarterly Change: +${escalation}%</div>
                                <div style="margin-bottom: 8px;">Risk Level: ${item.risk} PRIORITY</div>
                                <div style="margin-bottom: 4px;">${riskIcon} ${riskLevel}</div>
                                <div style="margin-bottom: 4px;">${actionRequired}</div>
                                <div style="margin-bottom: 4px;">Strategic Priority: #${item.priority} of 5</div>
                                <div style="margin-top: 8px; font-size: 11px; color: #bbb;">
                                    💼 Impact: Reputation & Investor Confidence
                                </div>
                            ` : ''}
                        </div>
                    `;
                    
                    tooltip.style.position = 'absolute';
                    tooltip.style.left = e.pageX + 10 + 'px';
                    tooltip.style.top = e.pageY - 10 + 'px';
                    tooltip.style.zIndex = '1000';
                    tooltip.className = 'progress-tooltip';
                    
                    document.body.appendChild(tooltip);
                });
                
                marker.addEventListener('mouseleave', function() {
                    const tooltips = document.querySelectorAll('.progress-tooltip');
                    tooltips.forEach(tooltip => tooltip.remove());
                });
            });
        }

        // Create Trust Drivers Chart (Stakeholder Trust Recovery)
        function createTrustDriversChart() {
            const ctx = document.getElementById('trustDriversChart');
            if (!ctx) return;

            // Stakeholder Trust Scores Data from CSV
            const data = {
                labels: ['Q1 2024', 'Q2 2024', 'Q3 2024', 'Q4 2024'],
                datasets: [{
                    label: 'Investor Trust',
                    data: [84.1, 77.92, 71.99, 83.03],
                    borderColor: '#0047BA',
                    backgroundColor: 'rgba(0, 71, 186, 0.1)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4
                }, {
                    label: 'IOC Relations',
                    data: [76.98, 76.15, 94.59, 92.74],
                    borderColor: '#27ae60',
                    backgroundColor: 'rgba(39, 174, 96, 0.1)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4
                }, {
                    label: 'Regulatory Trust',
                    data: [84.29, 60.25, 98.96, 98.31],
                    borderColor: '#f39c12',
                    backgroundColor: 'rgba(243, 156, 18, 0.1)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4
                }, {
                    label: 'Government Relations',
                    data: [83.47, 76.71, 75.6, 73.55],
                    borderColor: '#9b59b6',
                    backgroundColor: 'rgba(155, 89, 182, 0.1)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4
                }]
            };

            new Chart(ctx, {
                type: 'line',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    layout: {
                        padding: {
                            left: 15,
                            right: 15,
                            top: 15,
                            bottom: 50
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: { size: 11, weight: '600' },
                                padding: 15,
                                boxWidth: 12,
                                boxHeight: 12,
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                afterBody: function(context) {
                                    if (context[0].label === 'Q4 2024') {
                                        return [
                                            '',
                                            'Key Recovery Patterns:',
                                            '• Investor Trust: +15.3% rebound',
                                            '• IOC Relations: +21.8% improvement',
                                            '• Regulatory: Sustained high (98.31)',
                                            '• Government: Stable performance'
                                        ];
                                    }
                                    return null;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Quarter',
                                font: { size: 12, weight: 'bold' }
                            },
                            ticks: { font: { size: 11 } }
                        },
                        y: {
                            beginAtZero: false,
                            min: 50,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Trust Score (0-100)',
                                font: { size: 12, weight: 'bold' }
                            },
                            ticks: { font: { size: 11 } }
                        }
                    }
                }
            });
        }

        // Create Crisis Event Chart (Crisis Events Timeline) - Optimized for compact view
        function createCrisisEventChart() {
            const ctx = document.getElementById('crisisEventChart');
            if (!ctx) return;

            // Crisis Event Data from CSV
            const eventData = [
                { event: 'IEA Climate Outlook', date: 'Jan 15', sentiment: -6, media: 85 },
                { event: 'UAE Net Zero Update', date: 'Jan 28', sentiment: 4, media: 42 },
                { event: 'COP29 ESG Report', date: 'Feb 11', sentiment: -8, media: 96 },
                { event: 'Regional Conflict', date: 'Feb 22', sentiment: -10, media: 120 },
                { event: 'UN Hydrogen Strategy', date: 'Mar 5', sentiment: 5, media: 37 }
            ];

            const data = {
                labels: eventData.map(item => {
                    // Ultra-short labels for compact view
                    const compactLabels = {
                        'Jan 15': 'Jan 15',
                        'Jan 28': 'Jan 28', 
                        'Feb 11': 'Feb 11',
                        'Feb 22': 'Feb 22',
                        'Mar 5': 'Mar 5'
                    };
                    return compactLabels[item.date] || item.date;
                }),
                datasets: [{
                    label: 'Sentiment Impact',
                    data: eventData.map(item => item.sentiment),
                    backgroundColor: eventData.map(item => 
                        item.sentiment > 0 ? '#27ae60' : '#e74c3c'
                    ),
                    borderColor: eventData.map(item => 
                        item.sentiment > 0 ? '#229954' : '#c0392b'
                    ),
                    borderWidth: 1,
                    borderRadius: 4,
                    borderSkipped: false,
                    hoverBackgroundColor: eventData.map(item => 
                        item.sentiment > 0 ? '#229954' : '#c0392b'
                    ),
                    hoverBorderColor: eventData.map(item => 
                        item.sentiment > 0 ? '#1e8449' : '#a93226'
                    ),
                    hoverBorderWidth: 2,
                    type: 'bar'
                }, {
                    label: 'Media Coverage (%)',
                    data: eventData.map(item => item.media / 10), // Scale down for visibility
                    borderColor: '#0047BA',
                    backgroundColor: 'rgba(0, 71, 186, 0.1)',
                    borderWidth: 2,
                    fill: false,
                    type: 'line',
                    yAxisID: 'y1',
                    pointBackgroundColor: '#0047BA',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6
                }]
            };

                new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    layout: {
                        padding: {
                            left: 20,
                            right: 25,
                            top: 20,
                            bottom: 35
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: { 
                                font: { size: 9, weight: '600' },
                                padding: 6,
                                boxWidth: 8,
                                boxHeight: 8,
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#0047BA',
                            borderWidth: 2,
                            cornerRadius: 6,
                            displayColors: true,
                            callbacks: {
                                title: function(context) {
                                    const item = eventData[context[0].dataIndex];
                                    return item.event;
                                },
                                label: function(context) {
                                    const item = eventData[context.dataIndex];
                                    if (context.datasetIndex === 0) {
                                        const impact = item.sentiment > 0 ? `+${item.sentiment}` : `${item.sentiment}`;
                                        return `Sentiment Impact: ${impact}`;
                                    } else {
                                        return `Media Coverage: ${item.media}%`;
                                    }
                                },
                                afterBody: function(context) {
                                    const item = eventData[context[0].dataIndex];
                                    const impactType = item.sentiment > 0 ? 'Positive Event' : 'Negative Event';
                                    const severity = Math.abs(item.sentiment) >= 8 ? 'HIGH' : 
                                                   Math.abs(item.sentiment) >= 5 ? 'MEDIUM' : 'LOW';
                                    
                                    return [
                                        '',
                                        `Type: ${impactType}`,
                                        `Severity: ${severity}`,
                                        `Date: ${item.date}`,
                                        item.media >= 100 ? 'Major Media Event' : 'Standard Coverage'
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            ticks: { 
                                font: { size: 10, weight: '600' },
                                color: '#333',
                                padding: 4
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            beginAtZero: true,
                            min: -12,
                            max: 6,
                            title: {
                                display: false // Hide to save space
                            },
                            ticks: { 
                                font: { size: 10, weight: '600' },
                                color: '#666',
                                stepSize: 3,
                                padding: 4,
                                callback: function(value) {
                                    if (value === 0) return '0';
                                    return value > 0 ? `+${value}` : `${value}`;
                                }
                            },
                            grid: {
                                color: function(context) {
                                    if (context.tick.value === 0) {
                                        return 'rgba(0, 71, 186, 0.6)'; // Darker line at 0
                                    }
                                    return 'rgba(0, 71, 186, 0.1)';
                                },
                                lineWidth: function(context) {
                                    if (context.tick.value === 0) {
                                        return 2; // Thicker line at 0
                                    }
                                    return 1;
                                }
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            min: 0,
                            max: 15,
                            title: {
                                display: false // Hide to save space
                            },
                            ticks: { 
                                font: { size: 10, weight: '600' },
                                color: '#0047BA',
                                stepSize: 5,
                                padding: 4
                            },
                            grid: { 
                                drawOnChartArea: false,
                                color: 'rgba(0, 71, 186, 0.1)',
                                lineWidth: 1
                            }
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    elements: {
                        bar: {
                            borderSkipped: false
                        },
                        point: {
                            hoverBorderWidth: 3
                        }
                    }
                }
            });
        }

        // Create Trust Correlation Chart
        function createTrustCorrelationChart() {
            const ctx = document.getElementById('trustCorrelationChart');
            if (!ctx) return;

            const data = {
                labels: ['Execution', 'Innovation', 'Transparency', 'Reliability', 'Standards'],
                datasets: [{
                    label: 'Trust Correlation Score',
                    data: [92, 82, 84, 88, 76],
                    backgroundColor: [
                        'rgba(39, 174, 96, 0.8)',   // Execution - High
                        'rgba(243, 156, 18, 0.8)',  // Innovation - Medium
                        'rgba(52, 152, 219, 0.8)',  // Transparency - Medium-High
                        'rgba(155, 89, 182, 0.8)',  // Reliability - High
                        'rgba(231, 76, 60, 0.8)'    // Standards - Medium
                    ],
                    borderWidth: 2,
                    borderColor: '#fff'
                }]
            };

            new Chart(ctx, {
                type: 'doughnut',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { font: { size: 9 } }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const score = context.raw;
                                    const impact = score >= 85 ? 'High Impact' : 
                                                  score >= 75 ? 'Medium Impact' : 'Low Impact';
                                    return `${context.label}: ${score} (${impact})`;
                                }
                            }
                        }
                    }
                }
            });
        }

        // Create Trust Impact Horizontal Bar Chart with 0 in middle - Optimized for 300x400 view
        function createTrustWaterfallChart() {
            const ctx = document.getElementById('trustWaterfallChart');
            if (!ctx) return;

            // Trust Impact Drivers Data from CSV
            const trustImpactData = [
                { factor: 'Net Zero Roadmap Announcement', impact: 4, sentiment: 0.72, mentions: 86, tier: 'Tier 1' },
                { factor: 'Bloomberg ESG Summit', impact: 3, sentiment: 0.68, mentions: 74, tier: 'Tier 1' },
                { factor: 'Greenwashing Allegations', impact: -6, sentiment: -0.55, mentions: 39, tier: 'Tier 2' },
                { factor: 'Delayed CCS Implementation', impact: -5, sentiment: -0.49, mentions: 41, tier: 'Tier 1' },
                { factor: 'Hydrogen JV with US Partner', impact: 2, sentiment: 0.61, mentions: 55, tier: 'Tier 1' },
                { factor: 'Negative Think Tank Report', impact: -4, sentiment: -0.44, mentions: 33, tier: 'Tier 2' }
            ];

            // Sort with positive impacts at top, negative at bottom
            const sortedData = [...trustImpactData].sort((a, b) => {
                // First, separate positive and negative
                if (a.impact > 0 && b.impact <= 0) return -1; // a (positive) comes before b (negative)
                if (a.impact <= 0 && b.impact > 0) return 1;  // b (positive) comes before a (negative)
                
                // Within positive impacts, sort by magnitude (highest first)
                if (a.impact > 0 && b.impact > 0) return b.impact - a.impact;
                
                // Within negative impacts, sort by magnitude (most negative first)
                if (a.impact <= 0 && b.impact <= 0) return a.impact - b.impact;
                
                return 0;
            });

            const data = {
                labels: sortedData.map(item => {
                    // Ultra-short labels for compact view
                    const compactLabels = {
                        'Net Zero Roadmap Announcement': 'Net Zero',
                        'Bloomberg ESG Summit': 'Bloomberg ESG',
                        'Greenwashing Allegations': 'Greenwashing',
                        'Delayed CCS Implementation': 'CCS Delays',
                        'Hydrogen JV with US Partner': 'Hydrogen JV',
                        'Negative Think Tank Report': 'Think Tank'
                    };
                    return compactLabels[item.factor] || item.factor;
                }),
                datasets: [{
                    label: 'Trust Impact',
                    data: sortedData.map(item => item.impact),
                    backgroundColor: sortedData.map(item => 
                        item.impact > 0 ? '#27ae60' : '#e74c3c'
                    ),
                    borderColor: sortedData.map(item => 
                        item.impact > 0 ? '#229954' : '#c0392b'
                    ),
                    borderWidth: 1,
                    borderRadius: 4,
                    borderSkipped: false,
                    hoverBackgroundColor: sortedData.map(item => 
                        item.impact > 0 ? '#229954' : '#c0392b'
                    ),
                    hoverBorderColor: sortedData.map(item => 
                        item.impact > 0 ? '#1e8449' : '#a93226'
                    ),
                    hoverBorderWidth: 2
                }]
            };

            new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y', // Make it horizontal
                    animation: false,
                    layout: {
                        padding: {
                            left: 15,
                            right: 20,
                            top: 15,
                            bottom: 25
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#0047BA',
                            borderWidth: 2,
                            cornerRadius: 6,
                            displayColors: true,
                            callbacks: {
                                title: function(context) {
                                    const item = sortedData[context[0].dataIndex];
                                    return item.factor;
                                },
                                label: function(context) {
                                    const item = sortedData[context.dataIndex];
                                    const impact = item.impact > 0 ? `+${item.impact}` : `${item.impact}`;
                                    return [
                                        `Trust Impact: ${impact} points`,
                                        `Sentiment: ${(item.sentiment * 100).toFixed(0)}%`,
                                        `Mentions: ${item.mentions}`,
                                        `Tier: ${item.tier}`
                                    ];
                                },
                                afterBody: function(context) {
                                    const item = sortedData[context[0].dataIndex];
                                    const impactType = item.impact > 0 ? 'Trust Builder' : 'Trust Damager';
                                    const priority = Math.abs(item.impact) >= 5 ? 'HIGH' : 
                                                   Math.abs(item.impact) >= 3 ? 'MEDIUM' : 'LOW';
                                    
                                    return [
                                        '',
                                        `Type: ${impactType}`,
                                        `Priority: ${priority}`,
                                        item.tier === 'Tier 1' ? 'Premium Coverage' : 'Standard Coverage'
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            min: -7,
                            max: 5,
                            title: {
                                display: true,
                                text: 'Trust Impact Score',
                                font: {
                                    size: 11,
                                    weight: '600'
                                },
                                color: '#0047BA',
                                padding: 8
                            },
                            ticks: {
                                font: {
                                    size: 11,
                                    weight: '600'
                                },
                                color: '#666',
                                stepSize: 2,
                                padding: 8,
                                callback: function(value) {
                                    if (value === 0) return '0';
                                    return value > 0 ? `+${value}` : `${value}`;
                                }
                            },
                            grid: {
                                color: function(context) {
                                    if (context.tick.value === 0) {
                                        return 'rgba(0, 71, 186, 0.6)'; // Darker line at 0
                                    }
                                    return 'rgba(0, 71, 186, 0.1)';
                                },
                                lineWidth: function(context) {
                                    if (context.tick.value === 0) {
                                        return 2; // Thicker line at 0
                                    }
                                    return 1;
                                }
                            }
                        },
                        y: {
                            title: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 11,
                                    weight: '600'
                                },
                                color: '#333',
                                padding: 10
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    elements: {
                        bar: {
                            borderSkipped: false
                        }
                    }
                }
            });
        }

        // Initialize all charts
        function initializeCharts() {
            setTimeout(() => {
                createInvestorPerceptionChart();
                createKpiTrendChart();
                createSegmentationChart();
                createMessageResonanceChart();
                createContentFormatChart();
                createMessageTestingChart();
                createTrustDriverChart();
                createSentimentTrendChart();
                createTrustComponentsChart();
                createPriorityMatrixChart();
                createCampaignPerformanceChart();
                createMediaSentimentChart();
                createStakeholderEngagementChart();
                createMediaTierChart();
                createMediaDashboardChart();
                // New trust-focused charts for Page 3
                createTrustDamagersChart();
                createTrustDriversChart();
                createTrustWaterfallChart();
                createCrisisEventChart();
                createTrustCorrelationChart();
                // Low-Carbon Perception Intelligence charts - NOW PROPERLY CALLED
                createStakeholderPerceptionChart();
                createMediaNegativeGapChart();
                createMediaCoverageVolumeChart();
                populateConcernAlignmentTable();
                loadCampaignData();
                setupMetricToggles();
                setupMediaMetricToggles();
                populateMediaOutletTable();
            }, 500);
        }

        // Ensure charts are recreated when slides change
        function showSlide(n) {
            if (n > slides.length) { slideIndex = 1; }
            if (n < 1) { slideIndex = slides.length; }
            
            slides.forEach(slide => slide.classList.remove('active'));
            indicators.forEach(indicator => indicator.classList.remove('active'));
            
            slides[slideIndex - 1].classList.add('active');
            indicators[slideIndex - 1].classList.add('active');
            
            // Update navigation buttons
            document.getElementById('prevBtn').disabled = slideIndex === 1;
            document.getElementById('nextBtn').disabled = slideIndex === slides.length;
            
            // Recreate charts for the current slide to ensure they display properly
            setTimeout(() => {
                if (slideIndex === 3) { // Slide 3 - Trust analysis
                    createTrustDamagersChart();
                    createTrustDriversChart();
                    createTrustWaterfallChart();
                    createEventImpactChart();
                    createTrustCorrelationChart();
                } else if (slideIndex === 2) { // Slide 2 - Integrated insights
                    createMediaSentimentChart();
                    createMediaTierChart();
                    createMediaDashboardChart();
                    populateMediaOutletTable();
                } else if (slideIndex === 1) { // Slide 1 - Investor reactions
                    createInvestorPerceptionChart();
                    createKpiTrendChart();
                    createSegmentationChart();
                    createStakeholderEngagementChart();
                }
            }, 100);
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') changeSlide(-1);
            if (e.key === 'ArrowRight') changeSlide(1);
        });

        // Touch/swipe support for mobile
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', function(e) {
            touchStartX = e.changedTouches[0].screenX;
        });

        document.addEventListener('touchend', function(e) {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            if (touchEndX < touchStartX - 50) changeSlide(1);
            if (touchEndX > touchStartX + 50) changeSlide(-1);
        }

        // Low-Carbon Perception Intelligence Dashboard Functions
        
        // Data from the CSV files we analyzed
        const lowCarbonData = {
            stakeholderPerception: [
                { topic: 'Net Zero Pledge', positive: 73, neutral: 19, negative: 8, concern: 'Greenwashing suspicion' },
                { topic: 'Hydrogen Investment', positive: 68, neutral: 22, negative: 10, concern: 'ROI clarity' },
                { topic: 'Low-Carbon Tech Innovation', positive: 64, neutral: 24, negative: 12, concern: 'Scalability doubts' },
                { topic: 'Carbon Capture & Storage (CCS)', positive: 61, neutral: 25, negative: 14, concern: 'Timeline credibility' },
                { topic: 'Renewables Integration', positive: 58, neutral: 27, negative: 15, concern: 'Grid integration risk' },
                { topic: 'Green Finance/ESG Bonds', positive: 52, neutral: 30, negative: 18, concern: 'Lack of reporting standards' }
            ],
            mediaSentiment: [
                { topic: 'Carbon Capture & Storage (CCS)', positive: 42, neutral: 18, negative: 11, concern: 'Delayed CCS project timelines' },
                { topic: 'Hydrogen Investment', positive: 55, neutral: 22, negative: 8, concern: 'Unclear commercial viability' },
                { topic: 'Net Zero Pledge', positive: 61, neutral: 17, negative: 7, concern: 'Credibility vs. delivery gap' },
                { topic: 'Renewables Integration', positive: 39, neutral: 20, negative: 12, concern: 'Infrastructure readiness issues' },
                { topic: 'Green Finance/ESG Bonds', positive: 28, neutral: 15, negative: 9, concern: 'Lack of third-party ESG verification' },
                { topic: 'Low-Carbon Tech Innovation', positive: 33, neutral: 14, negative: 10, concern: 'Hype vs. proven application' }
            ],
            mediaCoverage: [
                { topic: 'Net Zero Pledge', mentions: 104 },
                { topic: 'Hydrogen Investment', mentions: 88 },
                { topic: 'Carbon Capture & Storage (CCS)', mentions: 71 },
                { topic: 'Renewables Integration', mentions: 66 },
                { topic: 'Low-Carbon Tech Innovation', mentions: 53 },
                { topic: 'Green Finance/ESG Bonds', mentions: 47 }
            ]
        };

        // Create Stakeholder Perception Breakdown Chart - Horizontal Bar Chart
        function createStakeholderPerceptionChart() {
            const ctx = document.getElementById('stakeholderPerceptionChart');
            if (!ctx) return;

            const isMobile = window.innerWidth < 480;
            const isTablet = window.innerWidth < 768;
            const sortedData = lowCarbonData.stakeholderPerception.sort((a, b) => b.positive - a.positive);

            const data = {
                labels: sortedData.map(item => {
                    // Match the exact same label mapping as mediaCoverageVolumeChart
                    if (isMobile) {
                        const shortLabels = {
                            'Net Zero Pledge': 'Net Zero',
                            'Hydrogen Investment': 'Hydrogen',
                            'Low-Carbon Tech Innovation': 'Innovation',
                            'Carbon Capture & Storage (CCS)': 'CCS',
                            'Renewables Integration': 'Renewables',
                            'Green Finance/ESG Bonds': 'Green Finance'
                        };
                        return shortLabels[item.topic] || item.topic;
                    }
                    return item.topic; // Full names for desktop/tablet
                }),
                datasets: [{
                    label: 'Positive',
                    data: sortedData.map(item => item.positive),
                    backgroundColor: '#a8d5a8',
                    borderWidth: 0,
                    borderRadius: 0
                }, {
                    label: 'Neutral',
                    data: sortedData.map(item => item.neutral),
                    backgroundColor: '#bdc3c7',
                    borderWidth: 0,
                    borderRadius: 0
                }, {
                    label: 'Negative',
                    data: sortedData.map(item => item.negative),
                    backgroundColor: '#f1a8a8',
                    borderWidth: 0,
                    borderRadius: 0
                }]
            };

            new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y', // Make it horizontal
                    animation: false,
                    layout: {
                        padding: {
                            left: isMobile ? 10 : 15,
                            right: isMobile ? 10 : 15,
                            top: isMobile ? 15 : 20,
                            bottom: isMobile ? 15 : 20
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: false
                            },
                            ticks: { 
                                font: { 
                                    size: isMobile ? 8 : 10
                                },
                                color: '#666',
                                stepSize: 20,
                                padding: isMobile ? 6 : 8
                            },
                            grid: {
                                color: 'rgba(0, 71, 186, 0.1)',
                                lineWidth: 1
                            }
                        },
                        y: {
                            stacked: true,
                            title: {
                                display: false
                            },
                            ticks: {
                                font: { 
                                    size: isMobile ? 8 : 10
                                },
                                color: '#333',
                                padding: isMobile ? 8 : 12
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { 
                                font: { 
                                    size: isMobile ? 8 : 10
                                },
                                boxWidth: isMobile ? 10 : 12,
                                padding: isMobile ? 12 : 15,
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#0047BA',
                            borderWidth: 2,
                            cornerRadius: 6,
                            displayColors: true,
                            callbacks: {
                                title: function(context) {
                                    return sortedData[context[0].dataIndex].topic;
                                },
                                afterBody: function(context) {
                                    const item = sortedData[context[0].dataIndex];
                                    return [
                                        '',
                                        `Top Concern: ${item.concern}`,
                                        `Total Sentiment: ${item.positive + item.neutral + item.negative}%`,
                                        `Performance: ${item.positive >= 70 ? 'Strong' : item.positive >= 60 ? 'Good' : 'Needs Focus'}`
                                    ];
                                }
                            }
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    elements: {
                        bar: {
                            borderSkipped: false
                        }
                    }
                }
            });
        }

        // Create Media vs Stakeholder Negative Gap Chart
        function createMediaNegativeGapChart() {
            const ctx = document.getElementById('mediaNegativeGapChart');
            if (!ctx) return;

            const isMobile = window.innerWidth < 480;
            
            // Calculate negative percentages for media
            const mediaWithNegative = lowCarbonData.mediaSentiment.map(item => {
                const total = item.positive + item.neutral + item.negative;
                return {
                    topic: item.topic,
                    negativePercent: Math.round((item.negative / total) * 100)
                };
            });

            // Match with stakeholder data
            const comparisonData = lowCarbonData.stakeholderPerception.map(stakeholder => {
                const media = mediaWithNegative.find(m => m.topic === stakeholder.topic);
                return {
                    topic: stakeholder.topic,
                    mediaNegative: media ? media.negativePercent : 0,
                    stakeholderNegative: stakeholder.negative
                };
            });

            const data = {
                labels: comparisonData.map(item => {
                    if (isMobile) {
                        const shortLabels = {
                            'Net Zero Pledge': 'Net Zero',
                            'Hydrogen Investment': 'Hydrogen',
                            'Low-Carbon Tech Innovation': 'Innovation',
                            'Carbon Capture & Storage (CCS)': 'CCS',
                            'Renewables Integration': 'Renewables',
                            'Green Finance/ESG Bonds': 'Green Finance'
                        };
                        return shortLabels[item.topic] || item.topic;
                    }
                    return item.topic;
                }),
                datasets: [{
                    label: 'Media Negative %',
                    data: comparisonData.map(item => item.mediaNegative),
                    backgroundColor: '#3498db',
                    borderWidth: 1,
                    borderRadius: 4
                }, {
                    label: 'Stakeholder Negative %',
                    data: comparisonData.map(item => item.stakeholderNegative),
                    backgroundColor: '#0047BA',
                    borderWidth: 1,
                    borderRadius: 4
                }]
            };

            new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y', // Make it horizontal
                    animation: false,
                    layout: {
                        padding: {
                            left: isMobile ? 10 : 15,
                            right: isMobile ? 10 : 15,
                            top: isMobile ? 15 : 20,
                            bottom: isMobile ? 15 : 20
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 20,
                            title: {
                                display: !isMobile,
                                text: 'Negative Sentiment (%)',
                                font: {
                                    size: isMobile ? 9 : 11,
                                    weight: '400',
                                    family: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
                                },
                                color: '#6c757d',
                                padding: isMobile ? 8 : 10
                            },
                            ticks: {
                                font: {
                                    size: isMobile ? 10 : 12,
                                    weight: '500',
                                    family: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
                                },
                                maxRotation: isMobile ? 25 : 0,
                                minRotation: 0,
                                color: '#2c3e50',
                                padding: isMobile ? 10 : 15,
                                callback: function(value) {
                                    return value + '%';
                                }
                            },
                            grid: {
                                color: 'rgba(0, 71, 186, 0.08)',
                                lineWidth: 1,
                                drawBorder: false
                            },
                            border: {
                                color: 'rgba(0, 71, 186, 0.2)',
                                width: 1
                            }
                        },
                        y: {
                            title: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: isMobile ? 8 : 10,
                                    weight: '500',
                                    family: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
                                },
                                color: '#333',
                                padding: isMobile ? 8 : 12
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    elements: {
                        bar: {
                            borderSkipped: false
                        }
                    }
                }
            });
        }

        // Create Media Coverage Volume Chart
        function createMediaCoverageVolumeChart() {
            const ctx = document.getElementById('mediaCoverageVolumeChart');
            if (!ctx) return;

            const isMobile = window.innerWidth < 480;
            const sortedData = lowCarbonData.mediaCoverage.sort((a, b) => b.mentions - a.mentions);

            const data = {
                labels: sortedData.map(item => {
                    if (isMobile) {
                        const shortLabels = {
                            'Net Zero Pledge': 'Net Zero',
                            'Hydrogen Investment': 'Hydrogen',
                            'Low-Carbon Tech Innovation': 'Innovation',
                            'Carbon Capture & Storage (CCS)': 'CCS',
                            'Renewables Integration': 'Renewables',
                            'Green Finance/ESG Bonds': 'Green Finance'
                        };
                        return shortLabels[item.topic] || item.topic;
                    }
                    return item.topic;
                }),
                datasets: [{
                    label: 'Mentions',
                    data: sortedData.map(item => item.mentions),
                    backgroundColor: sortedData.map(item => {
                        if (item.mentions >= 90) return '#0047BA'; // High volume - ADNOC Blue
                        if (item.mentions >= 70) return '#1565C0'; // Medium volume - Dark Blue
                        return '#42A5F5'; // Low volume - Light Blue
                    }),
                    borderWidth: 1,
                    borderRadius: 4
                }]
            };

            new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: { font: { size: isMobile ? 8 : 10 } }
                        },
                        y: {
                            ticks: {
                                font: { size: isMobile ? 8 : 10 }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return sortedData[context[0].dataIndex].topic;
                                },
                                label: function(context) {
                                    const mentions = context.raw;
                                    const volume = mentions >= 90 ? 'High' : mentions >= 70 ? 'Medium' : 'Low';
                                    return [`Mentions: ${mentions}`, `Volume: ${volume}`];
                                }
                            }
                        }
                    }
                }
            });
        }

        // Populate Concern Alignment Table
        function populateConcernAlignmentTable() {
            const tbody = document.getElementById('concernAlignmentTableBody');
            if (!tbody) return;

            const alignmentData = [
                { topic: 'CCS', mediaConcern: 'Delayed timelines', stakeholderConcern: 'Timeline cred.', status: '<svg width="16" height="16" viewBox="0 0 24 24" fill="#27ae60" style="vertical-align: middle;"><circle cx="12" cy="12" r="10" fill="#27ae60"/><path d="M9 12L11 14L15 10" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>', alignment: 'ALIGNED' },
                { topic: 'Green Finance', mediaConcern: 'ESG verification', stakeholderConcern: 'Reporting std.', status: '<svg width="16" height="16" viewBox="0 0 24 24" fill="#27ae60" style="vertical-align: middle;"><circle cx="12" cy="12" r="10" fill="#27ae60"/><path d="M9 12L11 14L15 10" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>', alignment: 'ALIGNED' },
                { topic: 'Hydrogen', mediaConcern: 'Commercial viability', stakeholderConcern: 'ROI clarity', status: '<svg width="16" height="16" viewBox="0 0 24 24" fill="#f39c12" style="vertical-align: middle;"><path d="M12 2L1 21H23L12 2Z" fill="#f39c12"/><path d="M12 8V12M12 16H12.01" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>', alignment: 'PARTIAL' },
                { topic: 'Renewables', mediaConcern: 'Infrastructure ready', stakeholderConcern: 'Grid integration', status: '<svg width="16" height="16" viewBox="0 0 24 24" fill="#f39c12" style="vertical-align: middle;"><path d="M12 2L1 21H23L12 2Z" fill="#f39c12"/><path d="M12 8V12M12 16H12.01" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>', alignment: 'PARTIAL' },
                { topic: 'Net Zero', mediaConcern: 'Delivery gap', stakeholderConcern: 'Greenwashing', status: '<svg width="16" height="16" viewBox="0 0 24 24" fill="#e74c3c" style="vertical-align: middle;"><circle cx="12" cy="12" r="10" fill="#e74c3c"/><path d="M15 9L9 15M9 9L15 15" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>', alignment: 'MISALIGNED' },
                { topic: 'Innovation', mediaConcern: 'Hype vs proof', stakeholderConcern: 'Scalability', status: '<svg width="16" height="16" viewBox="0 0 24 24" fill="#e74c3c" style="vertical-align: middle;"><circle cx="12" cy="12" r="10" fill="#e74c3c"/><path d="M15 9L9 15M9 9L15 15" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>', alignment: 'MISALIGNED' }
            ];

            tbody.innerHTML = '';
            
            alignmentData.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style="font-weight: 600;">${item.topic}</td>
                    <td>${item.mediaConcern}</td>
                    <td>${item.stakeholderConcern}</td>
                    <td>${item.status}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            showSlide(slideIndex);
            initializeCharts();
        });
    </script>
</body>
</html>
